distribute result [$$199] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
-- DISTRIBUTE_RESULT  |PARTITIONED|
  exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
    project ([$$199]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
    -- STREAM_PROJECT  |PARTITIONED|
      assign [$$199] <- [{"$1": 8, "o_year": $$o_year, "mkt_share": numeric-divide($$214, $$215)}] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
      -- ASSIGN  |PARTITIONED|
        exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
          group by ([$$o_year := $$238]) decor ([]) {
                    aggregate [$$214, $$215] <- [agg-global-sql-sum($$236), agg-global-sql-sum($$237)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                    -- AGGREGATE  |LOCAL|
                      nested tuple source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                      -- NESTED_TUPLE_SOURCE  |LOCAL|
                 } [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
          -- SORT_GROUP_BY[$$238]  |PARTITIONED|
            exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
            -- HASH_PARTITION_EXCHANGE [$$238]  |PARTITIONED|
              group by ([$$238 := $$200]) decor ([]) {
                        aggregate [$$236, $$237] <- [agg-local-sql-sum(switch-case(true, eq($$232, "PERU"), numeric-multiply($$230, numeric-subtract(1, $$231)), 0)), agg-local-sql-sum(numeric-multiply($$230, numeric-subtract(1, $$231)))] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                        -- AGGREGATE  |LOCAL|
                          nested tuple source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                          -- NESTED_TUPLE_SOURCE  |LOCAL|
                     } [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
              -- SORT_GROUP_BY[$$200]  |PARTITIONED|
                exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                  project ([$$232, $$230, $$231, $$200]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                  -- STREAM_PROJECT  |PARTITIONED|
                    assign [$$200] <- [get-year(date($$201))] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                    -- ASSIGN  |PARTITIONED|
                      project ([$$232, $$230, $$231, $$201]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                      -- STREAM_PROJECT  |PARTITIONED|
                        exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                          join (eq($$212, $$210)) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                          -- HYBRID_HASH_JOIN [$$212][$$210]  |PARTITIONED|
                            exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                            -- HASH_PARTITION_EXCHANGE [$$212]  |PARTITIONED|
                              project ([$$232, $$230, $$231, $$201, $$212]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                              -- STREAM_PROJECT  |PARTITIONED|
                                exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                  join (eq($$216, $$209)) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                  -- HYBRID_HASH_JOIN [$$216][$$209]  |PARTITIONED|
                                    exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                    -- HASH_PARTITION_EXCHANGE [$$216]  |PARTITIONED|
                                      project ([$$230, $$231, $$201, $$212, $$216]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                      -- STREAM_PROJECT  |PARTITIONED|
                                        exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                          join (eq($$218, $$208)) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                          -- HYBRID_HASH_JOIN [$$218][$$208]  |PARTITIONED|
                                            exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                            -- HASH_PARTITION_EXCHANGE [$$218]  |PARTITIONED|
                                              project ([$$230, $$231, $$201, $$216, $$218]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                              -- STREAM_PROJECT  |PARTITIONED|
                                                exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                  join (eq($$226, $$207)) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                  -- HYBRID_HASH_JOIN [$$226][$$207]  |PARTITIONED|
                                                    exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                    -- HASH_PARTITION_EXCHANGE [$$226]  |PARTITIONED|
                                                      project ([$$230, $$231, $$201, $$216, $$226]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                      -- STREAM_PROJECT  |PARTITIONED|
                                                        exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                          join (eq($$205, $$206)) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                          -- HYBRID_HASH_JOIN [$$205][$$206]  |PARTITIONED|
                                                            exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                            -- HASH_PARTITION_EXCHANGE [$$205]  |PARTITIONED|
                                                              project ([$$230, $$231, $$216, $$205]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                              -- STREAM_PROJECT  |PARTITIONED|
                                                                exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                  join (and(eq($$202, $$221), eq($$203, $$223))) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                  -- HYBRID_HASH_JOIN [$$202, $$203][$$221, $$223]  |PARTITIONED|
                                                                    exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                    -- HASH_PARTITION_EXCHANGE [$$202, $$203]  |PARTITIONED|
                                                                      join (true) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                      -- NESTED_LOOP  |PARTITIONED|
                                                                        exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                          project ([$$202]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                          -- STREAM_PROJECT  |PARTITIONED|
                                                                            select (eq($$p.getField(4), "ECONOMY BURNISHED NICKEL")) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                            -- STREAM_SELECT  |PARTITIONED|
                                                                              exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                data-scan []<-[$$202, $$p] <- tpch.part project ({p_type:any}) filter on: eq($$p.getField(4), "ECONOMY BURNISHED NICKEL") range-filter on: eq($$p.getField(4), "ECONOMY BURNISHED NICKEL") [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                  exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                    empty-tuple-source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                    -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                        exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                        -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                                          project ([$$216, $$203]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                          -- STREAM_PROJECT  |PARTITIONED|
                                                                            assign [$$216] <- [$$s.getField(3)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                            -- ASSIGN  |PARTITIONED|
                                                                              exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                data-scan []<-[$$203, $$s] <- tpch.supplier project ({s_nationkey:any}) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                  exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                    empty-tuple-source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                    -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                    exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                    -- HASH_PARTITION_EXCHANGE [$$221, $$223]  |PARTITIONED|
                                                                      project ([$$230, $$231, $$205, $$221, $$223]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                      -- STREAM_PROJECT  |PARTITIONED|
                                                                        assign [$$231, $$230, $$223, $$221] <- [$$l.getField(6), $$l.getField(5), $$l.getField(2), $$l.getField(1)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                        -- ASSIGN  |PARTITIONED|
                                                                          project ([$$205, $$l]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                          -- STREAM_PROJECT  |PARTITIONED|
                                                                            exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                              data-scan []<-[$$204, $$205, $$l] <- tpch.lineitem project ({l_partkey:any,l_extendedprice:any,l_suppkey:any,l_discount:any}) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                              -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                  empty-tuple-source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                  -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                            exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                            -- HASH_PARTITION_EXCHANGE [$$206]  |PARTITIONED|
                                                              select (and(ge($$201, "1995-01-01"), le($$201, "1996-12-31"))) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                              -- STREAM_SELECT  |PARTITIONED|
                                                                project ([$$206, $$226, $$201]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                -- STREAM_PROJECT  |PARTITIONED|
                                                                  assign [$$226, $$201] <- [$$o.getField(1), $$o.getField(4)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                  -- ASSIGN  |PARTITIONED|
                                                                    exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                      data-scan []<-[$$206, $$o] <- tpch.orders project ({o_orderdate:any,o_custkey:any}) filter on: and(ge($$o.getField(4), "1995-01-01"), le($$o.getField(4), "1996-12-31")) range-filter on: and(ge($$o.getField(4), "1995-01-01"), le($$o.getField(4), "1996-12-31")) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                      -- DATASOURCE_SCAN  |PARTITIONED|
                                                                        exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                          empty-tuple-source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                          -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                    exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                    -- HASH_PARTITION_EXCHANGE [$$207]  |PARTITIONED|
                                                      project ([$$218, $$207]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                      -- STREAM_PROJECT  |PARTITIONED|
                                                        assign [$$218] <- [$$c.getField(3)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                        -- ASSIGN  |PARTITIONED|
                                                          exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                            data-scan []<-[$$207, $$c] <- tpch.customer project ({c_nationkey:any}) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                            -- DATASOURCE_SCAN  |PARTITIONED|
                                                              exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                empty-tuple-source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                            exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                            -- HASH_PARTITION_EXCHANGE [$$208]  |PARTITIONED|
                                              project ([$$212, $$208]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                              -- STREAM_PROJECT  |PARTITIONED|
                                                assign [$$212] <- [$$n1.getField(2)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                -- ASSIGN  |PARTITIONED|
                                                  exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                    replicate [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                    -- REPLICATE  |PARTITIONED|
                                                      exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                        data-scan []<-[$$208, $$n1] <- tpch.nation project ({n_regionkey:any,n_name:any}) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                        -- DATASOURCE_SCAN  |PARTITIONED|
                                                          exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                            empty-tuple-source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                            -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                    exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                    -- HASH_PARTITION_EXCHANGE [$$209]  |PARTITIONED|
                                      project ([$$232, $$209]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                      -- STREAM_PROJECT  |PARTITIONED|
                                        assign [$$232] <- [$$n2.getField(1)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                        -- ASSIGN  |PARTITIONED|
                                          project ([$$209, $$n2]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                          -- STREAM_PROJECT  |PARTITIONED|
                                            assign [$$209, $$n2] <- [$$208, $$n1] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                            -- ASSIGN  |PARTITIONED|
                                              exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                replicate [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                -- REPLICATE  |PARTITIONED|
                                                  exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                    data-scan []<-[$$208, $$n1] <- tpch.nation project ({n_regionkey:any,n_name:any}) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                    -- DATASOURCE_SCAN  |PARTITIONED|
                                                      exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                        empty-tuple-source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                        -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                            exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                            -- HASH_PARTITION_EXCHANGE [$$210]  |PARTITIONED|
                              project ([$$210]) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                              -- STREAM_PROJECT  |PARTITIONED|
                                select (eq($$r.getField(1), "AMERICA")) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                -- STREAM_SELECT  |PARTITIONED|
                                  exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                    data-scan []<-[$$210, $$r] <- tpch.region project ({r_name:any}) filter on: eq($$r.getField(1), "AMERICA") range-filter on: eq($$r.getField(1), "AMERICA") [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                    -- DATASOURCE_SCAN  |PARTITIONED|
                                      exchange [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                        empty-tuple-source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                        -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
