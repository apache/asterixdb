distribute result [$$142]
-- DISTRIBUTE_RESULT  |PARTITIONED|
  exchange
  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
    join (true)
    -- NESTED_LOOP  |PARTITIONED|
      exchange
      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
        project ([])
        -- STREAM_PROJECT  |PARTITIONED|
          exchange
          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
            unnest-map [$$146, $$item] <- index-search("item", 0, "tpcds", "item", false, false, 1, $$201, 1, $$202, true, true, true)
            -- BTREE_SEARCH  |PARTITIONED|
              exchange
              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                assign [$$201, $$202] <- [1, 1]
                -- ASSIGN  |PARTITIONED|
                  empty-tuple-source
                  -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
      exchange
      -- BROADCAST_EXCHANGE  |LOCAL|
        project ([$$142])
        -- STREAM_PROJECT  |LOCAL|
          assign [$$142] <- [{"bucket1": $$140}]
          -- ASSIGN  |LOCAL|
            project ([$$140])
            -- STREAM_PROJECT  |LOCAL|
              unnest $$140 <- scan-collection($$139)
              -- UNNEST  |LOCAL|
                project ([$$139])
                -- STREAM_PROJECT  |LOCAL|
                  assign [$$139] <- [switch-case(true, lt(get-item($$193, 0), 25437), cast($$121), cast($$138))]
                  -- ASSIGN  |LOCAL|
                    exchange
                    -- ONE_TO_ONE_EXCHANGE  |LOCAL|
                      group by ([$$193 := $$166]) decor ([$$121]) {
                                aggregate [$$138] <- [listify($$137)]
                                -- AGGREGATE  |LOCAL|
                                  aggregate [$$137] <- [listify($$136)]
                                  -- AGGREGATE  |LOCAL|
                                    select (not(is-missing($$192)))
                                    -- STREAM_SELECT  |LOCAL|
                                      nested tuple source
                                      -- NESTED_TUPLE_SOURCE  |LOCAL|
                             }
                      -- PRE_CLUSTERED_GROUP_BY[$$166]  |LOCAL|
                        exchange
                        -- ONE_TO_ONE_EXCHANGE  |LOCAL|
                          project ([$$121, $$136, $$192, $$166])
                          -- STREAM_PROJECT  |LOCAL|
                            exchange
                            -- ONE_TO_ONE_EXCHANGE  |LOCAL|
                              left outer join (eq($$166, $$167))
                              -- HYBRID_HASH_JOIN [$$166][$$167]  |LOCAL|
                                exchange
                                -- ONE_TO_ONE_EXCHANGE  |LOCAL|
                                  group by ([$$166 := $$102]) decor ([]) {
                                            aggregate [$$121] <- [listify($$120)]
                                            -- AGGREGATE  |LOCAL|
                                              aggregate [$$120] <- [listify($$119)]
                                              -- AGGREGATE  |LOCAL|
                                                select (not(is-missing($$165)))
                                                -- STREAM_SELECT  |LOCAL|
                                                  nested tuple source
                                                  -- NESTED_TUPLE_SOURCE  |LOCAL|
                                         }
                                  -- PRE_CLUSTERED_GROUP_BY[$$102]  |LOCAL|
                                    exchange
                                    -- ONE_TO_ONE_EXCHANGE  |LOCAL|
                                      order (ASC, $$102)
                                      -- STABLE_SORT [$$102(ASC)]  |LOCAL|
                                        exchange
                                        -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                          project ([$$119, $$165, $$102])
                                          -- STREAM_PROJECT  |UNPARTITIONED|
                                            exchange
                                            -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                              left outer join (eq($$102, $$159))
                                              -- HYBRID_HASH_JOIN [$$102][$$159]  |UNPARTITIONED|
                                                exchange
                                                -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                                  project ([$$102])
                                                  -- STREAM_PROJECT  |UNPARTITIONED|
                                                    assign [$$102] <- [$$168]
                                                    -- ASSIGN  |UNPARTITIONED|
                                                      exchange
                                                      -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                                        replicate
                                                        -- REPLICATE  |UNPARTITIONED|
                                                          exchange
                                                          -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                                            project ([$$168])
                                                            -- STREAM_PROJECT  |UNPARTITIONED|
                                                              assign [$$168] <- [$$169]
                                                              -- ASSIGN  |UNPARTITIONED|
                                                                exchange
                                                                -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                                                  replicate
                                                                  -- REPLICATE  |UNPARTITIONED|
                                                                    exchange
                                                                    -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                                                      aggregate [$$169] <- [listify($$176)]
                                                                      -- AGGREGATE  |UNPARTITIONED|
                                                                        aggregate [$$176] <- [agg-sql-sum($$199)]
                                                                        -- AGGREGATE  |UNPARTITIONED|
                                                                          exchange
                                                                          -- RANDOM_MERGE_EXCHANGE  |PARTITIONED|
                                                                            aggregate [$$199] <- [agg-sql-count(1)]
                                                                            -- AGGREGATE  |PARTITIONED|
                                                                              select (and(ge($$178, 1), le($$178, 20)))
                                                                              -- STREAM_SELECT  |PARTITIONED|
                                                                                project ([$$178])
                                                                                -- STREAM_PROJECT  |PARTITIONED|
                                                                                  assign [$$178] <- [$$177.getField(10)]
                                                                                  -- ASSIGN  |PARTITIONED|
                                                                                    exchange
                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                      replicate
                                                                                      -- REPLICATE  |PARTITIONED|
                                                                                        exchange
                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                          project ([$$177])
                                                                                          -- STREAM_PROJECT  |PARTITIONED|
                                                                                            exchange
                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                              data-scan []<-[$$179, $$180, $$177] <- tpcds.store_sales
                                                                                              -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                exchange
                                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                  empty-tuple-source
                                                                                                  -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                exchange
                                                -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                                  join (true)
                                                  -- NESTED_LOOP  |UNPARTITIONED|
                                                    exchange
                                                    -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                                      project ([$$159, $$165])
                                                      -- STREAM_PROJECT  |UNPARTITIONED|
                                                        assign [$$159, $$165] <- [$$169, $$175]
                                                        -- ASSIGN  |UNPARTITIONED|
                                                          exchange
                                                          -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                                            replicate
                                                            -- REPLICATE  |UNPARTITIONED|
                                                              exchange
                                                              -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                                                assign [$$175] <- [true]
                                                                -- ASSIGN  |UNPARTITIONED|
                                                                  select (lt(get-item($$169, 0), 25437))
                                                                  -- STREAM_SELECT  |UNPARTITIONED|
                                                                    exchange
                                                                    -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                                                      replicate
                                                                      -- REPLICATE  |UNPARTITIONED|
                                                                        exchange
                                                                        -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                                                          aggregate [$$169] <- [listify($$176)]
                                                                          -- AGGREGATE  |UNPARTITIONED|
                                                                            aggregate [$$176] <- [agg-sql-sum($$199)]
                                                                            -- AGGREGATE  |UNPARTITIONED|
                                                                              exchange
                                                                              -- RANDOM_MERGE_EXCHANGE  |PARTITIONED|
                                                                                aggregate [$$199] <- [agg-sql-count(1)]
                                                                                -- AGGREGATE  |PARTITIONED|
                                                                                  select (and(ge($$178, 1), le($$178, 20)))
                                                                                  -- STREAM_SELECT  |PARTITIONED|
                                                                                    project ([$$178])
                                                                                    -- STREAM_PROJECT  |PARTITIONED|
                                                                                      assign [$$178] <- [$$177.getField(10)]
                                                                                      -- ASSIGN  |PARTITIONED|
                                                                                        exchange
                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                          replicate
                                                                                          -- REPLICATE  |PARTITIONED|
                                                                                            exchange
                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                              project ([$$177])
                                                                                              -- STREAM_PROJECT  |PARTITIONED|
                                                                                                exchange
                                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                  data-scan []<-[$$179, $$180, $$177] <- tpcds.store_sales
                                                                                                  -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                    exchange
                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                      empty-tuple-source
                                                                                                      -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                    exchange
                                                    -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                                      project ([$$119])
                                                      -- STREAM_PROJECT  |UNPARTITIONED|
                                                        assign [$$119] <- [{"$1": $$154}]
                                                        -- ASSIGN  |UNPARTITIONED|
                                                          aggregate [$$154] <- [agg-global-sql-avg($$197)]
                                                          -- AGGREGATE  |UNPARTITIONED|
                                                            exchange
                                                            -- RANDOM_MERGE_EXCHANGE  |PARTITIONED|
                                                              aggregate [$$197] <- [agg-local-sql-avg($$117)]
                                                              -- AGGREGATE  |PARTITIONED|
                                                                project ([$$117])
                                                                -- STREAM_PROJECT  |PARTITIONED|
                                                                  select (and(ge($$144, 1), le($$144, 20)))
                                                                  -- STREAM_SELECT  |PARTITIONED|
                                                                    project ([$$117, $$144])
                                                                    -- STREAM_PROJECT  |PARTITIONED|
                                                                      assign [$$117, $$144] <- [$$store_sales.getField(14), $$store_sales.getField(10)]
                                                                      -- ASSIGN  |PARTITIONED|
                                                                        project ([$$store_sales])
                                                                        -- STREAM_PROJECT  |PARTITIONED|
                                                                          assign [$$store_sales] <- [$$177]
                                                                          -- ASSIGN  |PARTITIONED|
                                                                            exchange
                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                              replicate
                                                                              -- REPLICATE  |PARTITIONED|
                                                                                exchange
                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                  project ([$$177])
                                                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                                                    exchange
                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                      data-scan []<-[$$179, $$180, $$177] <- tpcds.store_sales
                                                                                      -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                        exchange
                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                          empty-tuple-source
                                                                                          -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                exchange
                                -- ONE_TO_ONE_EXCHANGE  |LOCAL|
                                  join (true)
                                  -- NESTED_LOOP  |LOCAL|
                                    exchange
                                    -- ONE_TO_ONE_EXCHANGE  |LOCAL|
                                      assign [$$192] <- [true]
                                      -- ASSIGN  |LOCAL|
                                        project ([$$167])
                                        -- STREAM_PROJECT  |LOCAL|
                                          select (not(or(and($$205, not(is-unknown($$205))))))
                                          -- STREAM_SELECT  |LOCAL|
                                            assign [$$205] <- [lt(get-item($$167, 0), 25437)]
                                            -- ASSIGN  |LOCAL|
                                              exchange
                                              -- ONE_TO_ONE_EXCHANGE  |LOCAL|
                                                group by ([$$167 := $$168]) decor ([]) {
                                                          aggregate [] <- []
                                                          -- AGGREGATE  |LOCAL|
                                                            aggregate [] <- []
                                                            -- AGGREGATE  |LOCAL|
                                                              select (not(is-missing($$175)))
                                                              -- STREAM_SELECT  |LOCAL|
                                                                nested tuple source
                                                                -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                       }
                                                -- PRE_CLUSTERED_GROUP_BY[$$168]  |LOCAL|
                                                  exchange
                                                  -- ONE_TO_ONE_EXCHANGE  |LOCAL|
                                                    order (ASC, $$168)
                                                    -- STABLE_SORT [$$168(ASC)]  |LOCAL|
                                                      exchange
                                                      -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                                        project ([$$175, $$168])
                                                        -- STREAM_PROJECT  |UNPARTITIONED|
                                                          exchange
                                                          -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                                            left outer join (eq($$168, $$169))
                                                            -- HYBRID_HASH_JOIN [$$168][$$169]  |UNPARTITIONED|
                                                              exchange
                                                              -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                                                replicate
                                                                -- REPLICATE  |UNPARTITIONED|
                                                                  exchange
                                                                  -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                                                    project ([$$168])
                                                                    -- STREAM_PROJECT  |UNPARTITIONED|
                                                                      assign [$$168] <- [$$169]
                                                                      -- ASSIGN  |UNPARTITIONED|
                                                                        exchange
                                                                        -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                                                          replicate
                                                                          -- REPLICATE  |UNPARTITIONED|
                                                                            exchange
                                                                            -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                                                              aggregate [$$169] <- [listify($$176)]
                                                                              -- AGGREGATE  |UNPARTITIONED|
                                                                                aggregate [$$176] <- [agg-sql-sum($$199)]
                                                                                -- AGGREGATE  |UNPARTITIONED|
                                                                                  exchange
                                                                                  -- RANDOM_MERGE_EXCHANGE  |PARTITIONED|
                                                                                    aggregate [$$199] <- [agg-sql-count(1)]
                                                                                    -- AGGREGATE  |PARTITIONED|
                                                                                      select (and(ge($$178, 1), le($$178, 20)))
                                                                                      -- STREAM_SELECT  |PARTITIONED|
                                                                                        project ([$$178])
                                                                                        -- STREAM_PROJECT  |PARTITIONED|
                                                                                          assign [$$178] <- [$$177.getField(10)]
                                                                                          -- ASSIGN  |PARTITIONED|
                                                                                            exchange
                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                              replicate
                                                                                              -- REPLICATE  |PARTITIONED|
                                                                                                exchange
                                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                  project ([$$177])
                                                                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                                                                    exchange
                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                      data-scan []<-[$$179, $$180, $$177] <- tpcds.store_sales
                                                                                                      -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                        exchange
                                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                          empty-tuple-source
                                                                                                          -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                              exchange
                                                              -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                                                replicate
                                                                -- REPLICATE  |UNPARTITIONED|
                                                                  exchange
                                                                  -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                                                    assign [$$175] <- [true]
                                                                    -- ASSIGN  |UNPARTITIONED|
                                                                      select (lt(get-item($$169, 0), 25437))
                                                                      -- STREAM_SELECT  |UNPARTITIONED|
                                                                        exchange
                                                                        -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                                                          replicate
                                                                          -- REPLICATE  |UNPARTITIONED|
                                                                            exchange
                                                                            -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                                                              aggregate [$$169] <- [listify($$176)]
                                                                              -- AGGREGATE  |UNPARTITIONED|
                                                                                aggregate [$$176] <- [agg-sql-sum($$199)]
                                                                                -- AGGREGATE  |UNPARTITIONED|
                                                                                  exchange
                                                                                  -- RANDOM_MERGE_EXCHANGE  |PARTITIONED|
                                                                                    aggregate [$$199] <- [agg-sql-count(1)]
                                                                                    -- AGGREGATE  |PARTITIONED|
                                                                                      select (and(ge($$178, 1), le($$178, 20)))
                                                                                      -- STREAM_SELECT  |PARTITIONED|
                                                                                        project ([$$178])
                                                                                        -- STREAM_PROJECT  |PARTITIONED|
                                                                                          assign [$$178] <- [$$177.getField(10)]
                                                                                          -- ASSIGN  |PARTITIONED|
                                                                                            exchange
                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                              replicate
                                                                                              -- REPLICATE  |PARTITIONED|
                                                                                                exchange
                                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                  project ([$$177])
                                                                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                                                                    exchange
                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                      data-scan []<-[$$179, $$180, $$177] <- tpcds.store_sales
                                                                                                      -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                        exchange
                                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                          empty-tuple-source
                                                                                                          -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                    exchange
                                    -- ONE_TO_ONE_EXCHANGE  |UNPARTITIONED|
                                      project ([$$136])
                                      -- STREAM_PROJECT  |UNPARTITIONED|
                                        assign [$$136] <- [{"$2": $$155}]
                                        -- ASSIGN  |UNPARTITIONED|
                                          aggregate [$$155] <- [agg-global-sql-avg($$200)]
                                          -- AGGREGATE  |UNPARTITIONED|
                                            exchange
                                            -- RANDOM_MERGE_EXCHANGE  |PARTITIONED|
                                              aggregate [$$200] <- [agg-local-sql-avg($$134)]
                                              -- AGGREGATE  |PARTITIONED|
                                                project ([$$134])
                                                -- STREAM_PROJECT  |PARTITIONED|
                                                  select (and(ge($$145, 1), le($$145, 20)))
                                                  -- STREAM_SELECT  |PARTITIONED|
                                                    project ([$$134, $$145])
                                                    -- STREAM_PROJECT  |PARTITIONED|
                                                      assign [$$134, $$145] <- [$$store_sales.getField(22), $$store_sales.getField(10)]
                                                      -- ASSIGN  |PARTITIONED|
                                                        project ([$$store_sales])
                                                        -- STREAM_PROJECT  |PARTITIONED|
                                                          assign [$$store_sales] <- [$$177]
                                                          -- ASSIGN  |PARTITIONED|
                                                            exchange
                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                              replicate
                                                              -- REPLICATE  |PARTITIONED|
                                                                exchange
                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                  project ([$$177])
                                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                                    exchange
                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                      data-scan []<-[$$179, $$180, $$177] <- tpcds.store_sales
                                                                      -- DATASOURCE_SCAN  |PARTITIONED|
                                                                        exchange
                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                          empty-tuple-source
                                                                          -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
