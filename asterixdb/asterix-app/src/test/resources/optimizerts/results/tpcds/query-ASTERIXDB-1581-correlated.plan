distribute result [$$143]
-- DISTRIBUTE_RESULT  |PARTITIONED|
  exchange
  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
    project ([$$143])
    -- STREAM_PROJECT  |PARTITIONED|
      assign [$$143] <- [{"bucket1": $$141}]
      -- ASSIGN  |PARTITIONED|
        project ([$$141])
        -- STREAM_PROJECT  |PARTITIONED|
          unnest $$141 <- scan-collection($$140)
          -- UNNEST  |PARTITIONED|
            project ([$$140])
            -- STREAM_PROJECT  |PARTITIONED|
              assign [$$140] <- [switch-case(true, lt(get-item($$107, 0), 25437), cast($$124), cast($$139))]
              -- ASSIGN  |PARTITIONED|
                project ([$$139, $$107, $$124])
                -- STREAM_PROJECT  |PARTITIONED|
                  exchange
                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                    group by ([$$224 := $$180]) decor ([$$107; $$124]) {
                              aggregate [$$139] <- [listify($$138)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                              -- AGGREGATE  |LOCAL|
                                aggregate [$$138] <- [listify($$137)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                -- AGGREGATE  |LOCAL|
                                  select (not(is-missing($$223))) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                  -- STREAM_SELECT  |LOCAL|
                                    nested tuple source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                    -- NESTED_TUPLE_SOURCE  |LOCAL|
                           }
                    -- PRE_CLUSTERED_GROUP_BY[$$180]  |PARTITIONED|
                      exchange
                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                        project ([$$107, $$124, $$137, $$223, $$180])
                        -- STREAM_PROJECT  |PARTITIONED|
                          exchange
                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                            left outer join (eq($$180, $$222))
                            -- HYBRID_HASH_JOIN [$$180][$$222]  |PARTITIONED|
                              exchange
                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                group by ([$$180 := $$164]) decor ([$$107]) {
                                          aggregate [$$124] <- [listify($$123)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                          -- AGGREGATE  |LOCAL|
                                            aggregate [$$123] <- [listify($$122)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                            -- AGGREGATE  |LOCAL|
                                              select (not(is-missing($$179))) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                              -- STREAM_SELECT  |LOCAL|
                                                nested tuple source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                -- NESTED_TUPLE_SOURCE  |LOCAL|
                                       }
                                -- PRE_CLUSTERED_GROUP_BY[$$164]  |PARTITIONED|
                                  exchange
                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                    order (ASC, $$164)
                                    -- STABLE_SORT [$$164(ASC)]  |PARTITIONED|
                                      exchange
                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                        project ([$$107, $$122, $$179, $$164])
                                        -- STREAM_PROJECT  |PARTITIONED|
                                          exchange
                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                            left outer join (eq($$164, $$178))
                                            -- HYBRID_HASH_JOIN [$$164][$$178]  |PARTITIONED|
                                              exchange
                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                group by ([$$164 := $$144]) decor ([]) {
                                                          aggregate [$$107] <- [listify($$151)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                          -- AGGREGATE  |LOCAL|
                                                            aggregate [$$151] <- [agg-sql-count(1)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                            -- AGGREGATE  |LOCAL|
                                                              select (not(is-missing($$163))) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                              -- STREAM_SELECT  |LOCAL|
                                                                nested tuple source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                       }
                                                -- PRE_CLUSTERED_GROUP_BY[$$144]  |PARTITIONED|
                                                  exchange
                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                    project ([$$163, $$144])
                                                    -- STREAM_PROJECT  |PARTITIONED|
                                                      exchange
                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                        left outer join (eq($$154, $$144))
                                                        -- HYBRID_HASH_JOIN [$$144][$$154]  |PARTITIONED|
                                                          exchange
                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                            project ([$$144])
                                                            -- STREAM_PROJECT  |PARTITIONED|
                                                              assign [$$144, $$item] <- [$$206, $$202]
                                                              -- ASSIGN  |PARTITIONED|
                                                                exchange
                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                  replicate
                                                                  -- REPLICATE  |PARTITIONED|
                                                                    exchange
                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                      unnest-map [$$206, $$202] <- index-search("item", 0, "tpcds", "item", false, false, 1, $$247, 1, $$248, true, true, true)
                                                                      -- BTREE_SEARCH  |PARTITIONED|
                                                                        exchange
                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                          assign [$$247, $$248] <- [1, 1]
                                                                          -- ASSIGN  |PARTITIONED|
                                                                            empty-tuple-source
                                                                            -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                          exchange
                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                            project ([$$163, $$154])
                                                            -- STREAM_PROJECT  |PARTITIONED|
                                                              assign [$$163, $$154] <- [$$213, $$205]
                                                              -- ASSIGN  |PARTITIONED|
                                                                exchange
                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                  replicate
                                                                  -- REPLICATE  |PARTITIONED|
                                                                    exchange
                                                                    -- HASH_PARTITION_EXCHANGE [$$205]  |PARTITIONED|
                                                                      project ([$$213, $$205])
                                                                      -- STREAM_PROJECT  |PARTITIONED|
                                                                        assign [$$213, $$205] <- [true, $$214.getField(10)]
                                                                        -- ASSIGN  |PARTITIONED|
                                                                          project ([$$214])
                                                                          -- STREAM_PROJECT  |PARTITIONED|
                                                                            assign [$$214] <- [$$store_sales]
                                                                            -- ASSIGN  |PARTITIONED|
                                                                              exchange
                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                replicate
                                                                                -- REPLICATE  |PARTITIONED|
                                                                                  exchange
                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                    project ([$$store_sales])
                                                                                    -- STREAM_PROJECT  |PARTITIONED|
                                                                                      exchange
                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                        data-scan []<-[$$147, $$148, $$store_sales] <- tpcds.store_sales
                                                                                        -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                          exchange
                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                            empty-tuple-source
                                                                                            -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                              exchange
                                              -- HASH_PARTITION_EXCHANGE [$$178]  |PARTITIONED|
                                                project ([$$122, $$179, $$178])
                                                -- STREAM_PROJECT  |PARTITIONED|
                                                  assign [$$179, $$122] <- [true, {"$1": $$152}]
                                                  -- ASSIGN  |PARTITIONED|
                                                    project ([$$152, $$178])
                                                    -- STREAM_PROJECT  |PARTITIONED|
                                                      exchange
                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                        group by ([$$167 := $$227; $$178 := $$228]) decor ([]) {
                                                                  aggregate [$$152] <- [agg-global-sql-avg($$226)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                  -- AGGREGATE  |LOCAL|
                                                                    nested tuple source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                    -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                               }
                                                        -- SORT_GROUP_BY[$$227, $$228]  |PARTITIONED|
                                                          exchange
                                                          -- HASH_PARTITION_EXCHANGE [$$227, $$228]  |PARTITIONED|
                                                            group by ([$$227 := $$165; $$228 := $$168]) decor ([]) {
                                                                      aggregate [$$226] <- [agg-local-sql-avg($$120)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                      -- AGGREGATE  |LOCAL|
                                                                        select (not(is-missing($$166))) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                        -- STREAM_SELECT  |LOCAL|
                                                                          nested tuple source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                          -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                                   }
                                                            -- PRE_CLUSTERED_GROUP_BY[$$165, $$168]  |PARTITIONED|
                                                              exchange
                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                order (ASC, $$165) (ASC, $$168)
                                                                -- STABLE_SORT [$$165(ASC), $$168(ASC)]  |PARTITIONED|
                                                                  exchange
                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                    project ([$$120, $$166, $$165, $$168])
                                                                    -- STREAM_PROJECT  |PARTITIONED|
                                                                      exchange
                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                        left outer join (eq($$156, $$157))
                                                                        -- HYBRID_HASH_JOIN [$$157][$$156]  |PARTITIONED|
                                                                          exchange
                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                            project ([$$168, $$157, $$165])
                                                                            -- STREAM_PROJECT  |PARTITIONED|
                                                                              assign [$$168, $$157, $$165] <- [$$201, $$204, $$200]
                                                                              -- ASSIGN  |PARTITIONED|
                                                                                exchange
                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                  replicate
                                                                                  -- REPLICATE  |PARTITIONED|
                                                                                    exchange
                                                                                    -- HASH_PARTITION_EXCHANGE [$$204]  |PARTITIONED|
                                                                                      running-aggregate [$$200] <- [create-query-uid()]
                                                                                      -- RUNNING_AGGREGATE  |PARTITIONED|
                                                                                        project ([$$201, $$204])
                                                                                        -- STREAM_PROJECT  |PARTITIONED|
                                                                                          assign [$$204] <- [$$202.getField(0)]
                                                                                          -- ASSIGN  |PARTITIONED|
                                                                                            project ([$$201, $$202])
                                                                                            -- STREAM_PROJECT  |PARTITIONED|
                                                                                              select (lt(get-item($$203, 0), 25437))
                                                                                              -- STREAM_SELECT  |PARTITIONED|
                                                                                                exchange
                                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                  replicate
                                                                                                  -- REPLICATE  |PARTITIONED|
                                                                                                    exchange
                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                      group by ([$$201 := $$206]) decor ([$$202]) {
                                                                                                                aggregate [$$203] <- [listify($$212)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                -- AGGREGATE  |LOCAL|
                                                                                                                  aggregate [$$212] <- [agg-sql-count(1)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                  -- AGGREGATE  |LOCAL|
                                                                                                                    select (not(is-missing($$208))) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                    -- STREAM_SELECT  |LOCAL|
                                                                                                                      nested tuple source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                      -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                                                                             }
                                                                                                      -- PRE_CLUSTERED_GROUP_BY[$$206]  |PARTITIONED|
                                                                                                        exchange
                                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                          project ([$$202, $$208, $$206])
                                                                                                          -- STREAM_PROJECT  |PARTITIONED|
                                                                                                            exchange
                                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                              left outer join (eq($$207, $$206))
                                                                                                              -- HYBRID_HASH_JOIN [$$206][$$207]  |PARTITIONED|
                                                                                                                exchange
                                                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                  replicate
                                                                                                                  -- REPLICATE  |PARTITIONED|
                                                                                                                    exchange
                                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                      unnest-map [$$206, $$202] <- index-search("item", 0, "tpcds", "item", false, false, 1, $$247, 1, $$248, true, true, true)
                                                                                                                      -- BTREE_SEARCH  |PARTITIONED|
                                                                                                                        exchange
                                                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                          assign [$$247, $$248] <- [1, 1]
                                                                                                                          -- ASSIGN  |PARTITIONED|
                                                                                                                            empty-tuple-source
                                                                                                                            -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                                                                exchange
                                                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                  project ([$$208, $$207])
                                                                                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                    assign [$$208, $$207] <- [$$213, $$205]
                                                                                                                    -- ASSIGN  |PARTITIONED|
                                                                                                                      exchange
                                                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                        replicate
                                                                                                                        -- REPLICATE  |PARTITIONED|
                                                                                                                          exchange
                                                                                                                          -- HASH_PARTITION_EXCHANGE [$$205]  |PARTITIONED|
                                                                                                                            project ([$$213, $$205])
                                                                                                                            -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                              assign [$$213, $$205] <- [true, $$214.getField(10)]
                                                                                                                              -- ASSIGN  |PARTITIONED|
                                                                                                                                project ([$$214])
                                                                                                                                -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                  assign [$$214] <- [$$store_sales]
                                                                                                                                  -- ASSIGN  |PARTITIONED|
                                                                                                                                    exchange
                                                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                      replicate
                                                                                                                                      -- REPLICATE  |PARTITIONED|
                                                                                                                                        exchange
                                                                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                          project ([$$store_sales])
                                                                                                                                          -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                            exchange
                                                                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                              data-scan []<-[$$147, $$148, $$store_sales] <- tpcds.store_sales
                                                                                                                                              -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                                                                exchange
                                                                                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                  empty-tuple-source
                                                                                                                                                  -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                          exchange
                                                                          -- HASH_PARTITION_EXCHANGE [$$156]  |PARTITIONED|
                                                                            project ([$$120, $$166, $$156])
                                                                            -- STREAM_PROJECT  |PARTITIONED|
                                                                              assign [$$166, $$120, $$156] <- [true, $$store_sales.getField(14), $$store_sales.getField(10)]
                                                                              -- ASSIGN  |PARTITIONED|
                                                                                exchange
                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                  replicate
                                                                                  -- REPLICATE  |PARTITIONED|
                                                                                    exchange
                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                      project ([$$store_sales])
                                                                                      -- STREAM_PROJECT  |PARTITIONED|
                                                                                        exchange
                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                          data-scan []<-[$$147, $$148, $$store_sales] <- tpcds.store_sales
                                                                                          -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                            exchange
                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                              empty-tuple-source
                                                                                              -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                              exchange
                              -- HASH_PARTITION_EXCHANGE [$$222]  |PARTITIONED|
                                project ([$$137, $$223, $$222])
                                -- STREAM_PROJECT  |PARTITIONED|
                                  assign [$$223, $$137] <- [true, {"$2": $$153}]
                                  -- ASSIGN  |PARTITIONED|
                                    project ([$$153, $$222])
                                    -- STREAM_PROJECT  |PARTITIONED|
                                      exchange
                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                        group by ([$$183 := $$233; $$222 := $$234]) decor ([]) {
                                                  aggregate [$$153] <- [agg-global-sql-avg($$232)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                  -- AGGREGATE  |LOCAL|
                                                    nested tuple source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                    -- NESTED_TUPLE_SOURCE  |LOCAL|
                                               }
                                        -- SORT_GROUP_BY[$$233, $$234]  |PARTITIONED|
                                          exchange
                                          -- HASH_PARTITION_EXCHANGE [$$233, $$234]  |PARTITIONED|
                                            group by ([$$233 := $$181; $$234 := $$184]) decor ([]) {
                                                      aggregate [$$232] <- [agg-local-sql-avg($$135)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                      -- AGGREGATE  |LOCAL|
                                                        select (not(is-missing($$182))) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                        -- STREAM_SELECT  |LOCAL|
                                                          nested tuple source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                          -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                   }
                                            -- PRE_CLUSTERED_GROUP_BY[$$181, $$184]  |PARTITIONED|
                                              exchange
                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                order (ASC, $$181) (ASC, $$184)
                                                -- STABLE_SORT [$$181(ASC), $$184(ASC)]  |PARTITIONED|
                                                  exchange
                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                    project ([$$135, $$182, $$181, $$184])
                                                    -- STREAM_PROJECT  |PARTITIONED|
                                                      exchange
                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                        left outer join (eq($$158, $$159))
                                                        -- HYBRID_HASH_JOIN [$$159][$$158]  |PARTITIONED|
                                                          exchange
                                                          -- HASH_PARTITION_EXCHANGE [$$159]  |PARTITIONED|
                                                            running-aggregate [$$181] <- [create-query-uid()]
                                                            -- RUNNING_AGGREGATE  |PARTITIONED|
                                                              project ([$$184, $$159])
                                                              -- STREAM_PROJECT  |PARTITIONED|
                                                                assign [$$159] <- [$$186.getField(0)]
                                                                -- ASSIGN  |PARTITIONED|
                                                                  project ([$$184, $$186])
                                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                                    select (not(or(and($$251, not(is-unknown($$251))))))
                                                                    -- STREAM_SELECT  |PARTITIONED|
                                                                      project ([$$184, $$186, $$251])
                                                                      -- STREAM_PROJECT  |PARTITIONED|
                                                                        assign [$$251] <- [lt(get-item($$187, 0), 25437)]
                                                                        -- ASSIGN  |PARTITIONED|
                                                                          exchange
                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                            group by ([$$184 := $$185]) decor ([$$186; $$187]) {
                                                                                      aggregate [] <- [] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                      -- AGGREGATE  |LOCAL|
                                                                                        aggregate [] <- [] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                        -- AGGREGATE  |LOCAL|
                                                                                          select (not(is-missing($$196))) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                          -- STREAM_SELECT  |LOCAL|
                                                                                            nested tuple source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                            -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                                                   }
                                                                            -- PRE_CLUSTERED_GROUP_BY[$$185]  |PARTITIONED|
                                                                              exchange
                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                order (ASC, $$185)
                                                                                -- STABLE_SORT [$$185(ASC)]  |PARTITIONED|
                                                                                  exchange
                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                    project ([$$186, $$187, $$196, $$185])
                                                                                    -- STREAM_PROJECT  |PARTITIONED|
                                                                                      exchange
                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                        left outer join (eq($$185, $$188))
                                                                                        -- HYBRID_HASH_JOIN [$$185][$$188]  |PARTITIONED|
                                                                                          exchange
                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                            project ([$$187, $$185, $$186])
                                                                                            -- STREAM_PROJECT  |PARTITIONED|
                                                                                              assign [$$187, $$185, $$186] <- [$$203, $$201, $$202]
                                                                                              -- ASSIGN  |PARTITIONED|
                                                                                                exchange
                                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                  replicate
                                                                                                  -- REPLICATE  |PARTITIONED|
                                                                                                    exchange
                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                      group by ([$$201 := $$206]) decor ([$$202]) {
                                                                                                                aggregate [$$203] <- [listify($$212)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                -- AGGREGATE  |LOCAL|
                                                                                                                  aggregate [$$212] <- [agg-sql-count(1)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                  -- AGGREGATE  |LOCAL|
                                                                                                                    select (not(is-missing($$208))) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                    -- STREAM_SELECT  |LOCAL|
                                                                                                                      nested tuple source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                      -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                                                                             }
                                                                                                      -- PRE_CLUSTERED_GROUP_BY[$$206]  |PARTITIONED|
                                                                                                        exchange
                                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                          project ([$$202, $$208, $$206])
                                                                                                          -- STREAM_PROJECT  |PARTITIONED|
                                                                                                            exchange
                                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                              left outer join (eq($$207, $$206))
                                                                                                              -- HYBRID_HASH_JOIN [$$206][$$207]  |PARTITIONED|
                                                                                                                exchange
                                                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                  replicate
                                                                                                                  -- REPLICATE  |PARTITIONED|
                                                                                                                    exchange
                                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                      unnest-map [$$206, $$202] <- index-search("item", 0, "tpcds", "item", false, false, 1, $$247, 1, $$248, true, true, true)
                                                                                                                      -- BTREE_SEARCH  |PARTITIONED|
                                                                                                                        exchange
                                                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                          assign [$$247, $$248] <- [1, 1]
                                                                                                                          -- ASSIGN  |PARTITIONED|
                                                                                                                            empty-tuple-source
                                                                                                                            -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                                                                exchange
                                                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                  project ([$$208, $$207])
                                                                                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                    assign [$$208, $$207] <- [$$213, $$205]
                                                                                                                    -- ASSIGN  |PARTITIONED|
                                                                                                                      exchange
                                                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                        replicate
                                                                                                                        -- REPLICATE  |PARTITIONED|
                                                                                                                          exchange
                                                                                                                          -- HASH_PARTITION_EXCHANGE [$$205]  |PARTITIONED|
                                                                                                                            project ([$$213, $$205])
                                                                                                                            -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                              assign [$$213, $$205] <- [true, $$214.getField(10)]
                                                                                                                              -- ASSIGN  |PARTITIONED|
                                                                                                                                project ([$$214])
                                                                                                                                -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                  assign [$$214] <- [$$store_sales]
                                                                                                                                  -- ASSIGN  |PARTITIONED|
                                                                                                                                    exchange
                                                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                      replicate
                                                                                                                                      -- REPLICATE  |PARTITIONED|
                                                                                                                                        exchange
                                                                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                          project ([$$store_sales])
                                                                                                                                          -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                            exchange
                                                                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                              data-scan []<-[$$147, $$148, $$store_sales] <- tpcds.store_sales
                                                                                                                                              -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                                                                exchange
                                                                                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                  empty-tuple-source
                                                                                                                                                  -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                                          exchange
                                                                                          -- HASH_PARTITION_EXCHANGE [$$188]  |PARTITIONED|
                                                                                            assign [$$196] <- [true]
                                                                                            -- ASSIGN  |PARTITIONED|
                                                                                              project ([$$188])
                                                                                              -- STREAM_PROJECT  |PARTITIONED|
                                                                                                exchange
                                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                  group by ([$$199 := $$230; $$188 := $$231]) decor ([]) {
                                                                                                            aggregate [] <- [] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                            -- AGGREGATE  |LOCAL|
                                                                                                              nested tuple source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                              -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                                                                         }
                                                                                                  -- SORT_GROUP_BY[$$230, $$231]  |PARTITIONED|
                                                                                                    exchange
                                                                                                    -- HASH_PARTITION_EXCHANGE [$$230, $$231]  |PARTITIONED|
                                                                                                      group by ([$$230 := $$200; $$231 := $$201]) decor ([]) {
                                                                                                                aggregate [] <- [] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                -- AGGREGATE  |LOCAL|
                                                                                                                  select (not(is-missing($$213))) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                  -- STREAM_SELECT  |LOCAL|
                                                                                                                    nested tuple source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                    -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                                                                             }
                                                                                                      -- PRE_CLUSTERED_GROUP_BY[$$200, $$201]  |PARTITIONED|
                                                                                                        exchange
                                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                          order (ASC, $$200) (ASC, $$201)
                                                                                                          -- STABLE_SORT [$$200(ASC), $$201(ASC)]  |PARTITIONED|
                                                                                                            exchange
                                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                              project ([$$213, $$200, $$201])
                                                                                                              -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                exchange
                                                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                  left outer join (eq($$205, $$204))
                                                                                                                  -- HYBRID_HASH_JOIN [$$204][$$205]  |PARTITIONED|
                                                                                                                    exchange
                                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                      replicate
                                                                                                                      -- REPLICATE  |PARTITIONED|
                                                                                                                        exchange
                                                                                                                        -- HASH_PARTITION_EXCHANGE [$$204]  |PARTITIONED|
                                                                                                                          running-aggregate [$$200] <- [create-query-uid()]
                                                                                                                          -- RUNNING_AGGREGATE  |PARTITIONED|
                                                                                                                            project ([$$201, $$204])
                                                                                                                            -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                              assign [$$204] <- [$$202.getField(0)]
                                                                                                                              -- ASSIGN  |PARTITIONED|
                                                                                                                                project ([$$201, $$202])
                                                                                                                                -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                  select (lt(get-item($$203, 0), 25437))
                                                                                                                                  -- STREAM_SELECT  |PARTITIONED|
                                                                                                                                    exchange
                                                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                      replicate
                                                                                                                                      -- REPLICATE  |PARTITIONED|
                                                                                                                                        exchange
                                                                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                          group by ([$$201 := $$206]) decor ([$$202]) {
                                                                                                                                                    aggregate [$$203] <- [listify($$212)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                    -- AGGREGATE  |LOCAL|
                                                                                                                                                      aggregate [$$212] <- [agg-sql-count(1)] [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                      -- AGGREGATE  |LOCAL|
                                                                                                                                                        select (not(is-missing($$208))) [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                        -- STREAM_SELECT  |LOCAL|
                                                                                                                                                          nested tuple source [cardinality: 0.0, op-cost: 0.0, total-cost: 0.0]
                                                                                                                                                          -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                                                                                                                 }
                                                                                                                                          -- PRE_CLUSTERED_GROUP_BY[$$206]  |PARTITIONED|
                                                                                                                                            exchange
                                                                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                              project ([$$202, $$208, $$206])
                                                                                                                                              -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                                exchange
                                                                                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                  left outer join (eq($$207, $$206))
                                                                                                                                                  -- HYBRID_HASH_JOIN [$$206][$$207]  |PARTITIONED|
                                                                                                                                                    exchange
                                                                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                      replicate
                                                                                                                                                      -- REPLICATE  |PARTITIONED|
                                                                                                                                                        exchange
                                                                                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                          unnest-map [$$206, $$202] <- index-search("item", 0, "tpcds", "item", false, false, 1, $$247, 1, $$248, true, true, true)
                                                                                                                                                          -- BTREE_SEARCH  |PARTITIONED|
                                                                                                                                                            exchange
                                                                                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                              assign [$$247, $$248] <- [1, 1]
                                                                                                                                                              -- ASSIGN  |PARTITIONED|
                                                                                                                                                                empty-tuple-source
                                                                                                                                                                -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                                                                                                    exchange
                                                                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                      project ([$$208, $$207])
                                                                                                                                                      -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                                        assign [$$208, $$207] <- [$$213, $$205]
                                                                                                                                                        -- ASSIGN  |PARTITIONED|
                                                                                                                                                          exchange
                                                                                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                            replicate
                                                                                                                                                            -- REPLICATE  |PARTITIONED|
                                                                                                                                                              exchange
                                                                                                                                                              -- HASH_PARTITION_EXCHANGE [$$205]  |PARTITIONED|
                                                                                                                                                                project ([$$213, $$205])
                                                                                                                                                                -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                                                  assign [$$213, $$205] <- [true, $$214.getField(10)]
                                                                                                                                                                  -- ASSIGN  |PARTITIONED|
                                                                                                                                                                    project ([$$214])
                                                                                                                                                                    -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                                                      assign [$$214] <- [$$store_sales]
                                                                                                                                                                      -- ASSIGN  |PARTITIONED|
                                                                                                                                                                        exchange
                                                                                                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                                          replicate
                                                                                                                                                                          -- REPLICATE  |PARTITIONED|
                                                                                                                                                                            exchange
                                                                                                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                                              project ([$$store_sales])
                                                                                                                                                                              -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                                                                exchange
                                                                                                                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                                                  data-scan []<-[$$147, $$148, $$store_sales] <- tpcds.store_sales
                                                                                                                                                                                  -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                                                                                                    exchange
                                                                                                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                                                      empty-tuple-source
                                                                                                                                                                                      -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                                                                    exchange
                                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                      replicate
                                                                                                                      -- REPLICATE  |PARTITIONED|
                                                                                                                        exchange
                                                                                                                        -- HASH_PARTITION_EXCHANGE [$$205]  |PARTITIONED|
                                                                                                                          project ([$$213, $$205])
                                                                                                                          -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                            assign [$$213, $$205] <- [true, $$214.getField(10)]
                                                                                                                            -- ASSIGN  |PARTITIONED|
                                                                                                                              project ([$$214])
                                                                                                                              -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                assign [$$214] <- [$$store_sales]
                                                                                                                                -- ASSIGN  |PARTITIONED|
                                                                                                                                  exchange
                                                                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                    replicate
                                                                                                                                    -- REPLICATE  |PARTITIONED|
                                                                                                                                      exchange
                                                                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                        project ([$$store_sales])
                                                                                                                                        -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                          exchange
                                                                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                            data-scan []<-[$$147, $$148, $$store_sales] <- tpcds.store_sales
                                                                                                                                            -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                                                              exchange
                                                                                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                empty-tuple-source
                                                                                                                                                -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                          exchange
                                                          -- HASH_PARTITION_EXCHANGE [$$158]  |PARTITIONED|
                                                            project ([$$135, $$182, $$158])
                                                            -- STREAM_PROJECT  |PARTITIONED|
                                                              assign [$$182, $$135, $$158] <- [true, $$store_sales.getField(22), $$store_sales.getField(10)]
                                                              -- ASSIGN  |PARTITIONED|
                                                                project ([$$store_sales])
                                                                -- STREAM_PROJECT  |PARTITIONED|
                                                                  assign [$$store_sales] <- [$$store_sales]
                                                                  -- ASSIGN  |PARTITIONED|
                                                                    exchange
                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                      replicate
                                                                      -- REPLICATE  |PARTITIONED|
                                                                        exchange
                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                          project ([$$store_sales])
                                                                          -- STREAM_PROJECT  |PARTITIONED|
                                                                            exchange
                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                              data-scan []<-[$$147, $$148, $$store_sales] <- tpcds.store_sales
                                                                              -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                exchange
                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                  empty-tuple-source
                                                                                  -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
