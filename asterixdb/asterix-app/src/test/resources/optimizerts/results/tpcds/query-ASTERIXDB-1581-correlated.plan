distribute result [$$150]
-- DISTRIBUTE_RESULT  |PARTITIONED|
  exchange
  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
    assign [$$150] <- [{"bucket1": $$148}] project: [$$150]
    -- ASSIGN  |PARTITIONED|
      unnest $$148 <- scan-collection($$147) project: [$$148]
      -- UNNEST  |PARTITIONED|
        assign [$$147] <- [switch-case(true, lt(get-item($$114, 0), 25437), cast($$131), cast($$146))] project: [$$147]
        -- ASSIGN  |PARTITIONED|
          project ([$$146, $$114, $$131])
          -- STREAM_PROJECT  |PARTITIONED|
            exchange
            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
              group by ([$$231 := $$187]) decor ([$$114; $$131]) {
                        aggregate [$$146] <- [listify($$145)]
                        -- AGGREGATE  |LOCAL|
                          aggregate [$$145] <- [listify($$144)]
                          -- AGGREGATE  |LOCAL|
                            select (not(is-missing($$230)))
                            -- STREAM_SELECT  |LOCAL|
                              project ([$$144, $$230])
                              -- STREAM_PROJECT  |LOCAL|
                                nested tuple source
                                -- NESTED_TUPLE_SOURCE  |LOCAL|
                     }
              -- PRE_CLUSTERED_GROUP_BY[$$187]  |PARTITIONED|
                exchange
                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                  order (ASC, $$187)
                  -- STABLE_SORT [$$187(ASC)]  |PARTITIONED|
                    exchange
                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                      project ([$$114, $$131, $$144, $$230, $$187])
                      -- STREAM_PROJECT  |PARTITIONED|
                        exchange
                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                          left outer join (eq($$187, $$229))
                          -- HYBRID_HASH_JOIN [$$187][$$229]  |PARTITIONED|
                            exchange
                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                              group by ([$$187 := $$171]) decor ([$$114]) {
                                        aggregate [$$131] <- [listify($$130)]
                                        -- AGGREGATE  |LOCAL|
                                          aggregate [$$130] <- [listify($$129)]
                                          -- AGGREGATE  |LOCAL|
                                            select (not(is-missing($$186)))
                                            -- STREAM_SELECT  |LOCAL|
                                              project ([$$129, $$186])
                                              -- STREAM_PROJECT  |LOCAL|
                                                nested tuple source
                                                -- NESTED_TUPLE_SOURCE  |LOCAL|
                                     }
                              -- PRE_CLUSTERED_GROUP_BY[$$171]  |PARTITIONED|
                                exchange
                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                  project ([$$114, $$129, $$186, $$171])
                                  -- STREAM_PROJECT  |PARTITIONED|
                                    exchange
                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                      left outer join (eq($$171, $$185))
                                      -- HYBRID_HASH_JOIN [$$171][$$185]  |PARTITIONED|
                                        exchange
                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                          group by ([$$171 := $$151]) decor ([]) {
                                                    aggregate [$$114] <- [listify($$158)]
                                                    -- AGGREGATE  |LOCAL|
                                                      aggregate [$$158] <- [agg-sql-count(1)]
                                                      -- AGGREGATE  |LOCAL|
                                                        select (not(is-missing($$170)))
                                                        -- STREAM_SELECT  |LOCAL|
                                                          project ([$$170])
                                                          -- STREAM_PROJECT  |LOCAL|
                                                            nested tuple source
                                                            -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                 }
                                          -- PRE_CLUSTERED_GROUP_BY[$$151]  |PARTITIONED|
                                            exchange
                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                              order (ASC, $$151)
                                              -- STABLE_SORT [$$151(ASC)]  |PARTITIONED|
                                                exchange
                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                  project ([$$170, $$151])
                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                    exchange
                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                      left outer join (eq($$161, $$151))
                                                      -- HYBRID_HASH_JOIN [$$151][$$161]  |PARTITIONED|
                                                        exchange
                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                          assign [$$151, $$item] <- [$$213, $$211] project: [$$151]
                                                          -- ASSIGN  |PARTITIONED|
                                                            exchange
                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                              replicate
                                                              -- REPLICATE  |PARTITIONED|
                                                                exchange
                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                  unnest-map [$$213, $$211] <- index-search("item", 0, "Default", "tpcds", "item", false, false, 1, $$254, 1, $$255, true, true, true)
                                                                  -- BTREE_SEARCH  |PARTITIONED|
                                                                    exchange
                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                      assign [$$254, $$255] <- [1, 1]
                                                                      -- ASSIGN  |PARTITIONED|
                                                                        empty-tuple-source
                                                                        -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                        exchange
                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                          assign [$$170, $$161] <- [$$220, $$212] project: [$$170, $$161]
                                                          -- ASSIGN  |PARTITIONED|
                                                            exchange
                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                              replicate
                                                              -- REPLICATE  |PARTITIONED|
                                                                exchange
                                                                -- HASH_PARTITION_EXCHANGE [$$212]  |PARTITIONED|
                                                                  assign [$$220, $$212] <- [true, $$221.getField(10)] project: [$$220, $$212]
                                                                  -- ASSIGN  |PARTITIONED|
                                                                    assign [$$221] <- [$$store_sales] project: [$$221]
                                                                    -- ASSIGN  |PARTITIONED|
                                                                      exchange
                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                        replicate
                                                                        -- REPLICATE  |PARTITIONED|
                                                                          exchange
                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                            project ([$$store_sales])
                                                                            -- STREAM_PROJECT  |PARTITIONED|
                                                                              exchange
                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                data-scan []<-[$$154, $$155, $$store_sales] <- tpcds.store_sales
                                                                                -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                  exchange
                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                    empty-tuple-source
                                                                                    -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                        exchange
                                        -- HASH_PARTITION_EXCHANGE [$$185]  |PARTITIONED|
                                          assign [$$186, $$129] <- [true, {"$1": $$159}] project: [$$129, $$186, $$185]
                                          -- ASSIGN  |PARTITIONED|
                                            project ([$$159, $$185])
                                            -- STREAM_PROJECT  |PARTITIONED|
                                              exchange
                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                group by ([$$174 := $$234; $$185 := $$235]) decor ([]) {
                                                          aggregate [$$159] <- [agg-global-sql-avg($$233)]
                                                          -- AGGREGATE  |LOCAL|
                                                            nested tuple source
                                                            -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                       }
                                                -- SORT_GROUP_BY[$$234, $$235]  |PARTITIONED|
                                                  exchange
                                                  -- HASH_PARTITION_EXCHANGE [$$234, $$235]  |PARTITIONED|
                                                    group by ([$$234 := $$172; $$235 := $$175]) decor ([]) {
                                                              aggregate [$$233] <- [agg-local-sql-avg($$127)]
                                                              -- AGGREGATE  |LOCAL|
                                                                select (not(is-missing($$173)))
                                                                -- STREAM_SELECT  |LOCAL|
                                                                  project ([$$127, $$173])
                                                                  -- STREAM_PROJECT  |LOCAL|
                                                                    nested tuple source
                                                                    -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                           }
                                                    -- PRE_CLUSTERED_GROUP_BY[$$172, $$175]  |PARTITIONED|
                                                      exchange
                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                        order (ASC, $$172) (ASC, $$175)
                                                        -- STABLE_SORT [$$172(ASC), $$175(ASC)]  |PARTITIONED|
                                                          exchange
                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                            project ([$$127, $$173, $$172, $$175])
                                                            -- STREAM_PROJECT  |PARTITIONED|
                                                              exchange
                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                left outer join (eq($$163, $$164))
                                                                -- HYBRID_HASH_JOIN [$$164][$$163]  |PARTITIONED|
                                                                  exchange
                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                    assign [$$175, $$164, $$172] <- [$$208, $$210, $$207] project: [$$175, $$164, $$172]
                                                                    -- ASSIGN  |PARTITIONED|
                                                                      exchange
                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                        replicate
                                                                        -- REPLICATE  |PARTITIONED|
                                                                          exchange
                                                                          -- HASH_PARTITION_EXCHANGE [$$210]  |PARTITIONED|
                                                                            running-aggregate [$$207] <- [create-query-uid()]
                                                                            -- RUNNING_AGGREGATE  |PARTITIONED|
                                                                              assign [$$210] <- [$$211.getField(0)] project: [$$208, $$210]
                                                                              -- ASSIGN  |PARTITIONED|
                                                                                select (lt(get-item($$209, 0), 25437)) project: [$$208, $$211]
                                                                                -- STREAM_SELECT  |PARTITIONED|
                                                                                  exchange
                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                    replicate
                                                                                    -- REPLICATE  |PARTITIONED|
                                                                                      exchange
                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                        group by ([$$208 := $$213]) decor ([$$211]) {
                                                                                                  aggregate [$$209] <- [listify($$219)]
                                                                                                  -- AGGREGATE  |LOCAL|
                                                                                                    aggregate [$$219] <- [agg-sql-count(1)]
                                                                                                    -- AGGREGATE  |LOCAL|
                                                                                                      select (not(is-missing($$215)))
                                                                                                      -- STREAM_SELECT  |LOCAL|
                                                                                                        project ([$$215])
                                                                                                        -- STREAM_PROJECT  |LOCAL|
                                                                                                          nested tuple source
                                                                                                          -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                                                               }
                                                                                        -- PRE_CLUSTERED_GROUP_BY[$$213]  |PARTITIONED|
                                                                                          exchange
                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                            order (ASC, $$213)
                                                                                            -- STABLE_SORT [$$213(ASC)]  |PARTITIONED|
                                                                                              exchange
                                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                project ([$$211, $$215, $$213])
                                                                                                -- STREAM_PROJECT  |PARTITIONED|
                                                                                                  exchange
                                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                    left outer join (eq($$214, $$213))
                                                                                                    -- HYBRID_HASH_JOIN [$$213][$$214]  |PARTITIONED|
                                                                                                      exchange
                                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                        replicate
                                                                                                        -- REPLICATE  |PARTITIONED|
                                                                                                          exchange
                                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                            unnest-map [$$213, $$211] <- index-search("item", 0, "Default", "tpcds", "item", false, false, 1, $$254, 1, $$255, true, true, true)
                                                                                                            -- BTREE_SEARCH  |PARTITIONED|
                                                                                                              exchange
                                                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                assign [$$254, $$255] <- [1, 1]
                                                                                                                -- ASSIGN  |PARTITIONED|
                                                                                                                  empty-tuple-source
                                                                                                                  -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                                                      exchange
                                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                        assign [$$215, $$214] <- [$$220, $$212] project: [$$215, $$214]
                                                                                                        -- ASSIGN  |PARTITIONED|
                                                                                                          exchange
                                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                            replicate
                                                                                                            -- REPLICATE  |PARTITIONED|
                                                                                                              exchange
                                                                                                              -- HASH_PARTITION_EXCHANGE [$$212]  |PARTITIONED|
                                                                                                                assign [$$220, $$212] <- [true, $$221.getField(10)] project: [$$220, $$212]
                                                                                                                -- ASSIGN  |PARTITIONED|
                                                                                                                  assign [$$221] <- [$$store_sales] project: [$$221]
                                                                                                                  -- ASSIGN  |PARTITIONED|
                                                                                                                    exchange
                                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                      replicate
                                                                                                                      -- REPLICATE  |PARTITIONED|
                                                                                                                        exchange
                                                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                          project ([$$store_sales])
                                                                                                                          -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                            exchange
                                                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                              data-scan []<-[$$154, $$155, $$store_sales] <- tpcds.store_sales
                                                                                                                              -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                                                exchange
                                                                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                  empty-tuple-source
                                                                                                                                  -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                  exchange
                                                                  -- HASH_PARTITION_EXCHANGE [$$163]  |PARTITIONED|
                                                                    assign [$$173, $$127, $$163] <- [true, $$store_sales.getField(14), $$store_sales.getField(10)] project: [$$127, $$173, $$163]
                                                                    -- ASSIGN  |PARTITIONED|
                                                                      exchange
                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                        replicate
                                                                        -- REPLICATE  |PARTITIONED|
                                                                          exchange
                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                            project ([$$store_sales])
                                                                            -- STREAM_PROJECT  |PARTITIONED|
                                                                              exchange
                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                data-scan []<-[$$154, $$155, $$store_sales] <- tpcds.store_sales
                                                                                -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                  exchange
                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                    empty-tuple-source
                                                                                    -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                            exchange
                            -- HASH_PARTITION_EXCHANGE [$$229]  |PARTITIONED|
                              assign [$$230, $$144] <- [true, {"$2": $$160}] project: [$$144, $$230, $$229]
                              -- ASSIGN  |PARTITIONED|
                                project ([$$160, $$229])
                                -- STREAM_PROJECT  |PARTITIONED|
                                  exchange
                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                    group by ([$$190 := $$240; $$229 := $$241]) decor ([]) {
                                              aggregate [$$160] <- [agg-global-sql-avg($$239)]
                                              -- AGGREGATE  |LOCAL|
                                                nested tuple source
                                                -- NESTED_TUPLE_SOURCE  |LOCAL|
                                           }
                                    -- SORT_GROUP_BY[$$240, $$241]  |PARTITIONED|
                                      exchange
                                      -- HASH_PARTITION_EXCHANGE [$$240, $$241]  |PARTITIONED|
                                        group by ([$$240 := $$188; $$241 := $$191]) decor ([]) {
                                                  aggregate [$$239] <- [agg-local-sql-avg($$142)]
                                                  -- AGGREGATE  |LOCAL|
                                                    select (not(is-missing($$189)))
                                                    -- STREAM_SELECT  |LOCAL|
                                                      project ([$$142, $$189])
                                                      -- STREAM_PROJECT  |LOCAL|
                                                        nested tuple source
                                                        -- NESTED_TUPLE_SOURCE  |LOCAL|
                                               }
                                        -- PRE_CLUSTERED_GROUP_BY[$$188, $$191]  |PARTITIONED|
                                          exchange
                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                            order (ASC, $$188) (ASC, $$191)
                                            -- STABLE_SORT [$$188(ASC), $$191(ASC)]  |PARTITIONED|
                                              exchange
                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                project ([$$142, $$189, $$188, $$191])
                                                -- STREAM_PROJECT  |PARTITIONED|
                                                  exchange
                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                    left outer join (eq($$165, $$166))
                                                    -- HYBRID_HASH_JOIN [$$166][$$165]  |PARTITIONED|
                                                      exchange
                                                      -- HASH_PARTITION_EXCHANGE [$$166]  |PARTITIONED|
                                                        running-aggregate [$$188] <- [create-query-uid()]
                                                        -- RUNNING_AGGREGATE  |PARTITIONED|
                                                          assign [$$166] <- [$$194.getField(0)] project: [$$191, $$166]
                                                          -- ASSIGN  |PARTITIONED|
                                                            select (not(or(and($$258, not(is-unknown($$258)))))) project: [$$191, $$194]
                                                            -- STREAM_SELECT  |PARTITIONED|
                                                              assign [$$258] <- [lt(get-item($$193, 0), 25437)] project: [$$191, $$194, $$258]
                                                              -- ASSIGN  |PARTITIONED|
                                                                exchange
                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                  group by ([$$191 := $$192]) decor ([$$193; $$194]) {
                                                                            aggregate [] <- []
                                                                            -- AGGREGATE  |LOCAL|
                                                                              aggregate [] <- []
                                                                              -- AGGREGATE  |LOCAL|
                                                                                select (not(is-missing($$203)))
                                                                                -- STREAM_SELECT  |LOCAL|
                                                                                  project ([$$203])
                                                                                  -- STREAM_PROJECT  |LOCAL|
                                                                                    nested tuple source
                                                                                    -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                                         }
                                                                  -- PRE_CLUSTERED_GROUP_BY[$$192]  |PARTITIONED|
                                                                    exchange
                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                      project ([$$194, $$193, $$203, $$192])
                                                                      -- STREAM_PROJECT  |PARTITIONED|
                                                                        exchange
                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                          left outer join (eq($$192, $$195))
                                                                          -- HYBRID_HASH_JOIN [$$192][$$195]  |PARTITIONED|
                                                                            exchange
                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                              assign [$$193, $$192, $$194] <- [$$209, $$208, $$211] project: [$$193, $$192, $$194]
                                                                              -- ASSIGN  |PARTITIONED|
                                                                                exchange
                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                  replicate
                                                                                  -- REPLICATE  |PARTITIONED|
                                                                                    exchange
                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                      group by ([$$208 := $$213]) decor ([$$211]) {
                                                                                                aggregate [$$209] <- [listify($$219)]
                                                                                                -- AGGREGATE  |LOCAL|
                                                                                                  aggregate [$$219] <- [agg-sql-count(1)]
                                                                                                  -- AGGREGATE  |LOCAL|
                                                                                                    select (not(is-missing($$215)))
                                                                                                    -- STREAM_SELECT  |LOCAL|
                                                                                                      project ([$$215])
                                                                                                      -- STREAM_PROJECT  |LOCAL|
                                                                                                        nested tuple source
                                                                                                        -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                                                             }
                                                                                      -- PRE_CLUSTERED_GROUP_BY[$$213]  |PARTITIONED|
                                                                                        exchange
                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                          order (ASC, $$213)
                                                                                          -- STABLE_SORT [$$213(ASC)]  |PARTITIONED|
                                                                                            exchange
                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                              project ([$$211, $$215, $$213])
                                                                                              -- STREAM_PROJECT  |PARTITIONED|
                                                                                                exchange
                                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                  left outer join (eq($$214, $$213))
                                                                                                  -- HYBRID_HASH_JOIN [$$213][$$214]  |PARTITIONED|
                                                                                                    exchange
                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                      replicate
                                                                                                      -- REPLICATE  |PARTITIONED|
                                                                                                        exchange
                                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                          unnest-map [$$213, $$211] <- index-search("item", 0, "Default", "tpcds", "item", false, false, 1, $$254, 1, $$255, true, true, true)
                                                                                                          -- BTREE_SEARCH  |PARTITIONED|
                                                                                                            exchange
                                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                              assign [$$254, $$255] <- [1, 1]
                                                                                                              -- ASSIGN  |PARTITIONED|
                                                                                                                empty-tuple-source
                                                                                                                -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                                                    exchange
                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                      assign [$$215, $$214] <- [$$220, $$212] project: [$$215, $$214]
                                                                                                      -- ASSIGN  |PARTITIONED|
                                                                                                        exchange
                                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                          replicate
                                                                                                          -- REPLICATE  |PARTITIONED|
                                                                                                            exchange
                                                                                                            -- HASH_PARTITION_EXCHANGE [$$212]  |PARTITIONED|
                                                                                                              assign [$$220, $$212] <- [true, $$221.getField(10)] project: [$$220, $$212]
                                                                                                              -- ASSIGN  |PARTITIONED|
                                                                                                                assign [$$221] <- [$$store_sales] project: [$$221]
                                                                                                                -- ASSIGN  |PARTITIONED|
                                                                                                                  exchange
                                                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                    replicate
                                                                                                                    -- REPLICATE  |PARTITIONED|
                                                                                                                      exchange
                                                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                        project ([$$store_sales])
                                                                                                                        -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                          exchange
                                                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                            data-scan []<-[$$154, $$155, $$store_sales] <- tpcds.store_sales
                                                                                                                            -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                                              exchange
                                                                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                empty-tuple-source
                                                                                                                                -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                            exchange
                                                                            -- HASH_PARTITION_EXCHANGE [$$195]  |PARTITIONED|
                                                                              assign [$$203] <- [true]
                                                                              -- ASSIGN  |PARTITIONED|
                                                                                project ([$$195])
                                                                                -- STREAM_PROJECT  |PARTITIONED|
                                                                                  exchange
                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                    group by ([$$206 := $$237; $$195 := $$238]) decor ([]) {
                                                                                              aggregate [] <- []
                                                                                              -- AGGREGATE  |LOCAL|
                                                                                                nested tuple source
                                                                                                -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                                                           }
                                                                                    -- SORT_GROUP_BY[$$237, $$238]  |PARTITIONED|
                                                                                      exchange
                                                                                      -- HASH_PARTITION_EXCHANGE [$$237, $$238]  |PARTITIONED|
                                                                                        group by ([$$237 := $$207; $$238 := $$208]) decor ([]) {
                                                                                                  aggregate [] <- []
                                                                                                  -- AGGREGATE  |LOCAL|
                                                                                                    select (not(is-missing($$220)))
                                                                                                    -- STREAM_SELECT  |LOCAL|
                                                                                                      project ([$$220])
                                                                                                      -- STREAM_PROJECT  |LOCAL|
                                                                                                        nested tuple source
                                                                                                        -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                                                               }
                                                                                        -- PRE_CLUSTERED_GROUP_BY[$$207, $$208]  |PARTITIONED|
                                                                                          exchange
                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                            order (ASC, $$207) (ASC, $$208)
                                                                                            -- STABLE_SORT [$$207(ASC), $$208(ASC)]  |PARTITIONED|
                                                                                              exchange
                                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                project ([$$220, $$207, $$208])
                                                                                                -- STREAM_PROJECT  |PARTITIONED|
                                                                                                  exchange
                                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                    left outer join (eq($$212, $$210))
                                                                                                    -- HYBRID_HASH_JOIN [$$210][$$212]  |PARTITIONED|
                                                                                                      exchange
                                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                        replicate
                                                                                                        -- REPLICATE  |PARTITIONED|
                                                                                                          exchange
                                                                                                          -- HASH_PARTITION_EXCHANGE [$$210]  |PARTITIONED|
                                                                                                            running-aggregate [$$207] <- [create-query-uid()]
                                                                                                            -- RUNNING_AGGREGATE  |PARTITIONED|
                                                                                                              assign [$$210] <- [$$211.getField(0)] project: [$$208, $$210]
                                                                                                              -- ASSIGN  |PARTITIONED|
                                                                                                                select (lt(get-item($$209, 0), 25437)) project: [$$208, $$211]
                                                                                                                -- STREAM_SELECT  |PARTITIONED|
                                                                                                                  exchange
                                                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                    replicate
                                                                                                                    -- REPLICATE  |PARTITIONED|
                                                                                                                      exchange
                                                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                        group by ([$$208 := $$213]) decor ([$$211]) {
                                                                                                                                  aggregate [$$209] <- [listify($$219)]
                                                                                                                                  -- AGGREGATE  |LOCAL|
                                                                                                                                    aggregate [$$219] <- [agg-sql-count(1)]
                                                                                                                                    -- AGGREGATE  |LOCAL|
                                                                                                                                      select (not(is-missing($$215)))
                                                                                                                                      -- STREAM_SELECT  |LOCAL|
                                                                                                                                        project ([$$215])
                                                                                                                                        -- STREAM_PROJECT  |LOCAL|
                                                                                                                                          nested tuple source
                                                                                                                                          -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                                                                                               }
                                                                                                                        -- PRE_CLUSTERED_GROUP_BY[$$213]  |PARTITIONED|
                                                                                                                          exchange
                                                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                            order (ASC, $$213)
                                                                                                                            -- STABLE_SORT [$$213(ASC)]  |PARTITIONED|
                                                                                                                              exchange
                                                                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                project ([$$211, $$215, $$213])
                                                                                                                                -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                  exchange
                                                                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                    left outer join (eq($$214, $$213))
                                                                                                                                    -- HYBRID_HASH_JOIN [$$213][$$214]  |PARTITIONED|
                                                                                                                                      exchange
                                                                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                        replicate
                                                                                                                                        -- REPLICATE  |PARTITIONED|
                                                                                                                                          exchange
                                                                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                            unnest-map [$$213, $$211] <- index-search("item", 0, "Default", "tpcds", "item", false, false, 1, $$254, 1, $$255, true, true, true)
                                                                                                                                            -- BTREE_SEARCH  |PARTITIONED|
                                                                                                                                              exchange
                                                                                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                assign [$$254, $$255] <- [1, 1]
                                                                                                                                                -- ASSIGN  |PARTITIONED|
                                                                                                                                                  empty-tuple-source
                                                                                                                                                  -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                                                                                      exchange
                                                                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                        assign [$$215, $$214] <- [$$220, $$212] project: [$$215, $$214]
                                                                                                                                        -- ASSIGN  |PARTITIONED|
                                                                                                                                          exchange
                                                                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                            replicate
                                                                                                                                            -- REPLICATE  |PARTITIONED|
                                                                                                                                              exchange
                                                                                                                                              -- HASH_PARTITION_EXCHANGE [$$212]  |PARTITIONED|
                                                                                                                                                assign [$$220, $$212] <- [true, $$221.getField(10)] project: [$$220, $$212]
                                                                                                                                                -- ASSIGN  |PARTITIONED|
                                                                                                                                                  assign [$$221] <- [$$store_sales] project: [$$221]
                                                                                                                                                  -- ASSIGN  |PARTITIONED|
                                                                                                                                                    exchange
                                                                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                      replicate
                                                                                                                                                      -- REPLICATE  |PARTITIONED|
                                                                                                                                                        exchange
                                                                                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                          project ([$$store_sales])
                                                                                                                                                          -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                                                            exchange
                                                                                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                              data-scan []<-[$$154, $$155, $$store_sales] <- tpcds.store_sales
                                                                                                                                                              -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                                                                                exchange
                                                                                                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                                                                  empty-tuple-source
                                                                                                                                                                  -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                                                      exchange
                                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                        replicate
                                                                                                        -- REPLICATE  |PARTITIONED|
                                                                                                          exchange
                                                                                                          -- HASH_PARTITION_EXCHANGE [$$212]  |PARTITIONED|
                                                                                                            assign [$$220, $$212] <- [true, $$221.getField(10)] project: [$$220, $$212]
                                                                                                            -- ASSIGN  |PARTITIONED|
                                                                                                              assign [$$221] <- [$$store_sales] project: [$$221]
                                                                                                              -- ASSIGN  |PARTITIONED|
                                                                                                                exchange
                                                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                  replicate
                                                                                                                  -- REPLICATE  |PARTITIONED|
                                                                                                                    exchange
                                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                      project ([$$store_sales])
                                                                                                                      -- STREAM_PROJECT  |PARTITIONED|
                                                                                                                        exchange
                                                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                          data-scan []<-[$$154, $$155, $$store_sales] <- tpcds.store_sales
                                                                                                                          -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                                            exchange
                                                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                              empty-tuple-source
                                                                                                                              -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                      exchange
                                                      -- HASH_PARTITION_EXCHANGE [$$165]  |PARTITIONED|
                                                        assign [$$189, $$142, $$165] <- [true, $$store_sales.getField(22), $$store_sales.getField(10)] project: [$$142, $$189, $$165]
                                                        -- ASSIGN  |PARTITIONED|
                                                          assign [$$store_sales] <- [$$store_sales] project: [$$store_sales]
                                                          -- ASSIGN  |PARTITIONED|
                                                            exchange
                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                              replicate
                                                              -- REPLICATE  |PARTITIONED|
                                                                exchange
                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                  project ([$$store_sales])
                                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                                    exchange
                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                      data-scan []<-[$$154, $$155, $$store_sales] <- tpcds.store_sales
                                                                      -- DATASOURCE_SCAN  |PARTITIONED|
                                                                        exchange
                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                          empty-tuple-source
                                                                          -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
