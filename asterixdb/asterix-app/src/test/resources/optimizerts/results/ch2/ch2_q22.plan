distribute result [$$158]
-- DISTRIBUTE_RESULT  |PARTITIONED|
  exchange
  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
    assign [$$158] <- [{"country": $#1, "numcust": $$167, "totacctbal": $$168}] project: [$$158]
    -- ASSIGN  |PARTITIONED|
      exchange
      -- SORT_MERGE_EXCHANGE [$#1(ASC) ]  |PARTITIONED|
        group by ([$#1 := $$191]) decor ([]) {
                  aggregate [$$167, $$168] <- [agg-sql-sum($$189), agg-global-sql-sum($$190)]
                  -- AGGREGATE  |LOCAL|
                    nested tuple source
                    -- NESTED_TUPLE_SOURCE  |LOCAL|
               }
        -- SORT_GROUP_BY[$$191]  |PARTITIONED|
          exchange
          -- HASH_PARTITION_EXCHANGE [$$191]  |PARTITIONED|
            group by ([$$191 := $$159]) decor ([]) {
                      aggregate [$$189, $$190] <- [agg-sql-count(1), agg-local-sql-sum($$169)]
                      -- AGGREGATE  |LOCAL|
                        nested tuple source
                        -- NESTED_TUPLE_SOURCE  |LOCAL|
                   }
            -- SORT_GROUP_BY[$$159]  |PARTITIONED|
              exchange
              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                assign [$$159] <- [substring1($$180, 1, 1)] project: [$$169, $$159]
                -- ASSIGN  |PARTITIONED|
                  select (not(neq($$166, 0))) project: [$$169, $$180]
                  -- STREAM_SELECT  |PARTITIONED|
                    project ([$$166, $$169, $$180])
                    -- STREAM_PROJECT  |PARTITIONED|
                      exchange
                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                        group by ([$$185 := $$188]) decor ([$$169; $$180]) {
                                  aggregate [$$166] <- [agg-sum($$187)]
                                  -- AGGREGATE  |LOCAL|
                                    nested tuple source
                                    -- NESTED_TUPLE_SOURCE  |LOCAL|
                               }
                        -- SORT_GROUP_BY[$$188]  |PARTITIONED|
                          exchange
                          -- HASH_PARTITION_EXCHANGE [$$188]  |PARTITIONED|
                            group by ([$$188 := $$183]) decor ([$$169; $$180]) {
                                      aggregate [$$187] <- [agg-count(1)]
                                      -- AGGREGATE  |LOCAL|
                                        select (not(is-missing($$184)))
                                        -- STREAM_SELECT  |LOCAL|
                                          project ([$$184])
                                          -- STREAM_PROJECT  |LOCAL|
                                            nested tuple source
                                            -- NESTED_TUPLE_SOURCE  |LOCAL|
                                   }
                            -- PRE_CLUSTERED_GROUP_BY[$$183]  |PARTITIONED|
                              exchange
                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                order (ASC, $$183)
                                -- STABLE_SORT [$$183(ASC)]  |PARTITIONED|
                                  exchange
                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                    project ([$$169, $$180, $$184, $$183])
                                    -- STREAM_PROJECT  |PARTITIONED|
                                      exchange
                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                        left outer join (and(eq($$171, $$172), eq($$173, $$174), eq($$175, $$176)))
                                        -- HYBRID_HASH_JOIN [$$172, $$174, $$176][$$171, $$173, $$175]  |PARTITIONED|
                                          exchange
                                          -- HASH_PARTITION_EXCHANGE [$$172, $$174, $$176]  |PARTITIONED|
                                            running-aggregate [$$183] <- [create-query-uid()]
                                            -- RUNNING_AGGREGATE  |PARTITIONED|
                                              project ([$$169, $$180, $$172, $$174, $$176])
                                              -- STREAM_PROJECT  |PARTITIONED|
                                                exchange
                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                  join (gt($$169, $$170))
                                                  -- NESTED_LOOP  |PARTITIONED|
                                                    exchange
                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                      project ([$$169, $$180, $$172, $$174, $$176])
                                                      -- STREAM_PROJECT  |PARTITIONED|
                                                        exchange
                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                          join (eq($$164, $$102))
                                                          -- HYBRID_HASH_JOIN [$$102][$$164]  |PARTITIONED|
                                                            exchange
                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                              assign [$$102, $$180, $$176, $$174, $$172, $$169] <- [substring1($$c.getField("c_phone"), 1, 1), $$c.getField("c_state"), $$c.getField("c_w_id"), $$c.getField("c_id"), $$c.getField("c_d_id"), $$c.getField("c_balance")] project: [$$169, $$180, $$172, $$174, $$176, $$102]
                                                              -- ASSIGN  |PARTITIONED|
                                                                assign [$$c] <- [$$c1] project: [$$c]
                                                                -- ASSIGN  |PARTITIONED|
                                                                  exchange
                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                    replicate
                                                                    -- REPLICATE  |PARTITIONED|
                                                                      exchange
                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                        project ([$$c1])
                                                                        -- STREAM_PROJECT  |PARTITIONED|
                                                                          exchange
                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                            data-scan []<-[$$162, $$c1] <- test.customer
                                                                            -- DATASOURCE_SCAN  |PARTITIONED|
                                                                              exchange
                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                empty-tuple-source
                                                                                -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                            exchange
                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                              assign [$$164] <- [$$165] project: [$$164]
                                                              -- ASSIGN  |PARTITIONED|
                                                                exchange
                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                  replicate
                                                                  -- REPLICATE  |PARTITIONED|
                                                                    exchange
                                                                    -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                                      unnest $$165 <- scan-collection(array: [ "1", "2", "3", "4", "5", "6", "7" ])
                                                                      -- UNNEST  |UNPARTITIONED|
                                                                        empty-tuple-source
                                                                        -- EMPTY_TUPLE_SOURCE  |UNPARTITIONED|
                                                    exchange
                                                    -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                      assign [$$170] <- [get-item($$121, 0)] project: [$$170]
                                                      -- ASSIGN  |UNPARTITIONED|
                                                        aggregate [$$121] <- [listify($$186)]
                                                        -- AGGREGATE  |UNPARTITIONED|
                                                          aggregate [$$186] <- [agg-global-sql-avg($$192)]
                                                          -- AGGREGATE  |UNPARTITIONED|
                                                            exchange
                                                            -- RANDOM_MERGE_EXCHANGE  |PARTITIONED|
                                                              aggregate [$$192] <- [agg-local-sql-avg($$178)]
                                                              -- AGGREGATE  |PARTITIONED|
                                                                project ([$$178])
                                                                -- STREAM_PROJECT  |PARTITIONED|
                                                                  exchange
                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                    join (eq($$165, $$110))
                                                                    -- HYBRID_HASH_JOIN [$$110][$$165]  |PARTITIONED|
                                                                      exchange
                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                        assign [$$110] <- [substring1($$c1.getField("c_phone"), 1, 1)] project: [$$178, $$110]
                                                                        -- ASSIGN  |PARTITIONED|
                                                                          select (gt($$178, 0.0))
                                                                          -- STREAM_SELECT  |PARTITIONED|
                                                                            assign [$$178] <- [$$c1.getField("c_balance")]
                                                                            -- ASSIGN  |PARTITIONED|
                                                                              exchange
                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                replicate
                                                                                -- REPLICATE  |PARTITIONED|
                                                                                  exchange
                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                    project ([$$c1])
                                                                                    -- STREAM_PROJECT  |PARTITIONED|
                                                                                      exchange
                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                        data-scan []<-[$$162, $$c1] <- test.customer
                                                                                        -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                          exchange
                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                            empty-tuple-source
                                                                                            -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                      exchange
                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                        replicate
                                                                        -- REPLICATE  |PARTITIONED|
                                                                          exchange
                                                                          -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                                            unnest $$165 <- scan-collection(array: [ "1", "2", "3", "4", "5", "6", "7" ])
                                                                            -- UNNEST  |UNPARTITIONED|
                                                                              empty-tuple-source
                                                                              -- EMPTY_TUPLE_SOURCE  |UNPARTITIONED|
                                          exchange
                                          -- HASH_PARTITION_EXCHANGE [$$171, $$173, $$175]  |PARTITIONED|
                                            assign [$$184] <- [true]
                                            -- ASSIGN  |PARTITIONED|
                                              select (and(ge($$160, "2013-12-01 00:00:00"), le($$160, "2013-12-31 00:00:00"))) project: [$$175, $$173, $$171]
                                              -- STREAM_SELECT  |PARTITIONED|
                                                assign [$$175, $$173, $$171, $$160] <- [$$o.getField("o_w_id"), $$o.getField("o_c_id"), $$o.getField("o_d_id"), $$o.getField("o_entry_d")] project: [$$175, $$173, $$171, $$160]
                                                -- ASSIGN  |PARTITIONED|
                                                  project ([$$o])
                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                    exchange
                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                      data-scan []<-[$$163, $$o] <- test.orders
                                                      -- DATASOURCE_SCAN  |PARTITIONED|
                                                        exchange
                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                          empty-tuple-source
                                                          -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
