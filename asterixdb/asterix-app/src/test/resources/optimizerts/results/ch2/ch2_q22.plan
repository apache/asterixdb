distribute result [$$147]
-- DISTRIBUTE_RESULT  |PARTITIONED|
  exchange
  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
    assign [$$147] <- [{"country": $#1, "numcust": $$156, "totacctbal": $$157}] project: [$$147]
    -- ASSIGN  |PARTITIONED|
      exchange
      -- SORT_MERGE_EXCHANGE [$#1(ASC) ]  |PARTITIONED|
        group by ([$#1 := $$180]) decor ([]) {
                  aggregate [$$156, $$157] <- [agg-sql-sum($$178), agg-global-sql-sum($$179)]
                  -- AGGREGATE  |LOCAL|
                    nested tuple source
                    -- NESTED_TUPLE_SOURCE  |LOCAL|
               }
        -- SORT_GROUP_BY[$$180]  |PARTITIONED|
          exchange
          -- HASH_PARTITION_EXCHANGE [$$180]  |PARTITIONED|
            group by ([$$180 := $$148]) decor ([]) {
                      aggregate [$$178, $$179] <- [agg-sql-count(1), agg-local-sql-sum($$158)]
                      -- AGGREGATE  |LOCAL|
                        nested tuple source
                        -- NESTED_TUPLE_SOURCE  |LOCAL|
                   }
            -- SORT_GROUP_BY[$$148]  |PARTITIONED|
              exchange
              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                assign [$$148] <- [substring1($$169, 1, 1)] project: [$$158, $$148]
                -- ASSIGN  |PARTITIONED|
                  select (not(neq($$155, 0))) project: [$$169, $$158]
                  -- STREAM_SELECT  |PARTITIONED|
                    project ([$$155, $$169, $$158])
                    -- STREAM_PROJECT  |PARTITIONED|
                      exchange
                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                        group by ([$$174 := $$177]) decor ([$$169; $$158]) {
                                  aggregate [$$155] <- [agg-sum($$176)]
                                  -- AGGREGATE  |LOCAL|
                                    nested tuple source
                                    -- NESTED_TUPLE_SOURCE  |LOCAL|
                               }
                        -- SORT_GROUP_BY[$$177]  |PARTITIONED|
                          exchange
                          -- HASH_PARTITION_EXCHANGE [$$177]  |PARTITIONED|
                            group by ([$$177 := $$172]) decor ([$$169; $$158]) {
                                      aggregate [$$176] <- [agg-count(1)]
                                      -- AGGREGATE  |LOCAL|
                                        select (not(is-missing($$173)))
                                        -- STREAM_SELECT  |LOCAL|
                                          project ([$$173])
                                          -- STREAM_PROJECT  |LOCAL|
                                            nested tuple source
                                            -- NESTED_TUPLE_SOURCE  |LOCAL|
                                   }
                            -- PRE_CLUSTERED_GROUP_BY[$$172]  |PARTITIONED|
                              exchange
                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                order (ASC, $$172)
                                -- STABLE_SORT [$$172(ASC)]  |PARTITIONED|
                                  exchange
                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                    project ([$$158, $$169, $$173, $$172])
                                    -- STREAM_PROJECT  |PARTITIONED|
                                      exchange
                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                        left outer join (and(eq($$160, $$161), eq($$162, $$163), eq($$164, $$165)))
                                        -- HYBRID_HASH_JOIN [$$161, $$163, $$165][$$160, $$162, $$164]  |PARTITIONED|
                                          exchange
                                          -- HASH_PARTITION_EXCHANGE [$$161, $$163, $$165]  |PARTITIONED|
                                            running-aggregate [$$172] <- [create-query-uid()]
                                            -- RUNNING_AGGREGATE  |PARTITIONED|
                                              project ([$$158, $$169, $$161, $$163, $$165])
                                              -- STREAM_PROJECT  |PARTITIONED|
                                                exchange
                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                  join (gt($$158, $$159))
                                                  -- NESTED_LOOP  |PARTITIONED|
                                                    exchange
                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                      project ([$$158, $$169, $$161, $$163, $$165])
                                                      -- STREAM_PROJECT  |PARTITIONED|
                                                        exchange
                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                          join (eq($$153, $$91))
                                                          -- HYBRID_HASH_JOIN [$$91][$$153]  |PARTITIONED|
                                                            exchange
                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                              assign [$$91, $$169, $$165, $$163, $$161, $$158] <- [substring1($$c.getField("c_phone"), 1, 1), $$c.getField("c_state"), $$c.getField("c_w_id"), $$c.getField("c_id"), $$c.getField("c_d_id"), $$c.getField("c_balance")] project: [$$158, $$169, $$161, $$163, $$165, $$91]
                                                              -- ASSIGN  |PARTITIONED|
                                                                assign [$$c] <- [$$c1] project: [$$c]
                                                                -- ASSIGN  |PARTITIONED|
                                                                  exchange
                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                    replicate
                                                                    -- REPLICATE  |PARTITIONED|
                                                                      exchange
                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                        project ([$$c1])
                                                                        -- STREAM_PROJECT  |PARTITIONED|
                                                                          exchange
                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                            data-scan []<-[$$151, $$c1] <- test.customer
                                                                            -- DATASOURCE_SCAN  |PARTITIONED|
                                                                              exchange
                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                empty-tuple-source
                                                                                -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                            exchange
                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                              assign [$$153] <- [$$154] project: [$$153]
                                                              -- ASSIGN  |PARTITIONED|
                                                                exchange
                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                  replicate
                                                                  -- REPLICATE  |PARTITIONED|
                                                                    exchange
                                                                    -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                                      unnest $$154 <- scan-collection(array: [ "1", "2", "3", "4", "5", "6", "7" ])
                                                                      -- UNNEST  |UNPARTITIONED|
                                                                        empty-tuple-source
                                                                        -- EMPTY_TUPLE_SOURCE  |UNPARTITIONED|
                                                    exchange
                                                    -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                      assign [$$159] <- [get-item($$110, 0)] project: [$$159]
                                                      -- ASSIGN  |UNPARTITIONED|
                                                        aggregate [$$110] <- [listify($$175)]
                                                        -- AGGREGATE  |UNPARTITIONED|
                                                          aggregate [$$175] <- [agg-global-sql-avg($$181)]
                                                          -- AGGREGATE  |UNPARTITIONED|
                                                            exchange
                                                            -- RANDOM_MERGE_EXCHANGE  |PARTITIONED|
                                                              aggregate [$$181] <- [agg-local-sql-avg($$167)]
                                                              -- AGGREGATE  |PARTITIONED|
                                                                project ([$$167])
                                                                -- STREAM_PROJECT  |PARTITIONED|
                                                                  exchange
                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                    join (eq($$154, $$99))
                                                                    -- HYBRID_HASH_JOIN [$$99][$$154]  |PARTITIONED|
                                                                      exchange
                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                        assign [$$99] <- [substring1($$c1.getField("c_phone"), 1, 1)] project: [$$167, $$99]
                                                                        -- ASSIGN  |PARTITIONED|
                                                                          select (gt($$167, 0.0))
                                                                          -- STREAM_SELECT  |PARTITIONED|
                                                                            assign [$$167] <- [$$c1.getField("c_balance")]
                                                                            -- ASSIGN  |PARTITIONED|
                                                                              exchange
                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                replicate
                                                                                -- REPLICATE  |PARTITIONED|
                                                                                  exchange
                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                    project ([$$c1])
                                                                                    -- STREAM_PROJECT  |PARTITIONED|
                                                                                      exchange
                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                        data-scan []<-[$$151, $$c1] <- test.customer
                                                                                        -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                          exchange
                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                            empty-tuple-source
                                                                                            -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                      exchange
                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                        replicate
                                                                        -- REPLICATE  |PARTITIONED|
                                                                          exchange
                                                                          -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                                            unnest $$154 <- scan-collection(array: [ "1", "2", "3", "4", "5", "6", "7" ])
                                                                            -- UNNEST  |UNPARTITIONED|
                                                                              empty-tuple-source
                                                                              -- EMPTY_TUPLE_SOURCE  |UNPARTITIONED|
                                          exchange
                                          -- HASH_PARTITION_EXCHANGE [$$160, $$162, $$164]  |PARTITIONED|
                                            assign [$$173] <- [true]
                                            -- ASSIGN  |PARTITIONED|
                                              select (and(ge($$149, "2013-12-01 00:00:00"), le($$149, "2013-12-31 00:00:00"))) project: [$$164, $$162, $$160]
                                              -- STREAM_SELECT  |PARTITIONED|
                                                assign [$$164, $$162, $$160, $$149] <- [$$o.getField("o_w_id"), $$o.getField("o_c_id"), $$o.getField("o_d_id"), $$o.getField("o_entry_d")] project: [$$164, $$162, $$160, $$149]
                                                -- ASSIGN  |PARTITIONED|
                                                  project ([$$o])
                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                    exchange
                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                      data-scan []<-[$$152, $$o] <- test.orders
                                                      -- DATASOURCE_SCAN  |PARTITIONED|
                                                        exchange
                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                          empty-tuple-source
                                                          -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
