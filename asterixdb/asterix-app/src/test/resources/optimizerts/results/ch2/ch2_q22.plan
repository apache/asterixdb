distribute result [$$153]
-- DISTRIBUTE_RESULT  |PARTITIONED|
  exchange
  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
    assign [$$153] <- [{"country": $#1, "numcust": $$162, "totacctbal": $$163}] project: [$$153]
    -- ASSIGN  |PARTITIONED|
      exchange
      -- SORT_MERGE_EXCHANGE [$#1(ASC) ]  |PARTITIONED|
        group by ([$#1 := $$186]) decor ([]) {
                  aggregate [$$162, $$163] <- [agg-sql-sum($$184), agg-global-sql-sum($$185)]
                  -- AGGREGATE  |LOCAL|
                    nested tuple source
                    -- NESTED_TUPLE_SOURCE  |LOCAL|
               }
        -- SORT_GROUP_BY[$$186]  |PARTITIONED|
          exchange
          -- HASH_PARTITION_EXCHANGE [$$186]  |PARTITIONED|
            group by ([$$186 := $$154]) decor ([]) {
                      aggregate [$$184, $$185] <- [agg-sql-count(1), agg-local-sql-sum($$164)]
                      -- AGGREGATE  |LOCAL|
                        nested tuple source
                        -- NESTED_TUPLE_SOURCE  |LOCAL|
                   }
            -- SORT_GROUP_BY[$$154]  |PARTITIONED|
              exchange
              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                assign [$$154] <- [substring1($$175, 1, 1)] project: [$$164, $$154]
                -- ASSIGN  |PARTITIONED|
                  select (not(neq($$161, 0))) project: [$$164, $$175]
                  -- STREAM_SELECT  |PARTITIONED|
                    project ([$$161, $$164, $$175])
                    -- STREAM_PROJECT  |PARTITIONED|
                      exchange
                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                        group by ([$$180 := $$183]) decor ([$$164; $$175]) {
                                  aggregate [$$161] <- [agg-sum($$182)]
                                  -- AGGREGATE  |LOCAL|
                                    nested tuple source
                                    -- NESTED_TUPLE_SOURCE  |LOCAL|
                               }
                        -- SORT_GROUP_BY[$$183]  |PARTITIONED|
                          exchange
                          -- HASH_PARTITION_EXCHANGE [$$183]  |PARTITIONED|
                            group by ([$$183 := $$178]) decor ([$$164; $$175]) {
                                      aggregate [$$182] <- [agg-count(1)]
                                      -- AGGREGATE  |LOCAL|
                                        select (not(is-missing($$179)))
                                        -- STREAM_SELECT  |LOCAL|
                                          project ([$$179])
                                          -- STREAM_PROJECT  |LOCAL|
                                            nested tuple source
                                            -- NESTED_TUPLE_SOURCE  |LOCAL|
                                   }
                            -- PRE_CLUSTERED_GROUP_BY[$$178]  |PARTITIONED|
                              exchange
                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                order (ASC, $$178)
                                -- STABLE_SORT [$$178(ASC)]  |PARTITIONED|
                                  exchange
                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                    project ([$$164, $$175, $$179, $$178])
                                    -- STREAM_PROJECT  |PARTITIONED|
                                      exchange
                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                        left outer join (and(eq($$166, $$167), eq($$168, $$169), eq($$170, $$171)))
                                        -- HYBRID_HASH_JOIN [$$167, $$169, $$171][$$166, $$168, $$170]  |PARTITIONED|
                                          exchange
                                          -- HASH_PARTITION_EXCHANGE [$$167, $$169, $$171]  |PARTITIONED|
                                            running-aggregate [$$178] <- [create-query-uid()]
                                            -- RUNNING_AGGREGATE  |PARTITIONED|
                                              project ([$$164, $$175, $$167, $$169, $$171])
                                              -- STREAM_PROJECT  |PARTITIONED|
                                                exchange
                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                  join (gt($$164, $$165))
                                                  -- NESTED_LOOP  |PARTITIONED|
                                                    exchange
                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                      project ([$$164, $$175, $$167, $$169, $$171])
                                                      -- STREAM_PROJECT  |PARTITIONED|
                                                        exchange
                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                          join (eq($$159, $$97))
                                                          -- HYBRID_HASH_JOIN [$$97][$$159]  |PARTITIONED|
                                                            exchange
                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                              assign [$$97, $$175, $$171, $$169, $$167, $$164] <- [substring1($$c.getField("c_phone"), 1, 1), $$c.getField("c_state"), $$c.getField("c_w_id"), $$c.getField("c_id"), $$c.getField("c_d_id"), $$c.getField("c_balance")] project: [$$164, $$175, $$167, $$169, $$171, $$97]
                                                              -- ASSIGN  |PARTITIONED|
                                                                assign [$$c] <- [$$c1] project: [$$c]
                                                                -- ASSIGN  |PARTITIONED|
                                                                  exchange
                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                    replicate
                                                                    -- REPLICATE  |PARTITIONED|
                                                                      exchange
                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                        project ([$$c1])
                                                                        -- STREAM_PROJECT  |PARTITIONED|
                                                                          exchange
                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                            data-scan []<-[$$157, $$c1] <- test.customer
                                                                            -- DATASOURCE_SCAN  |PARTITIONED|
                                                                              exchange
                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                empty-tuple-source
                                                                                -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                            exchange
                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                              assign [$$159] <- [$$160] project: [$$159]
                                                              -- ASSIGN  |PARTITIONED|
                                                                exchange
                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                  replicate
                                                                  -- REPLICATE  |PARTITIONED|
                                                                    exchange
                                                                    -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                                      unnest $$160 <- scan-collection(array: [ "1", "2", "3", "4", "5", "6", "7" ])
                                                                      -- UNNEST  |UNPARTITIONED|
                                                                        empty-tuple-source
                                                                        -- EMPTY_TUPLE_SOURCE  |UNPARTITIONED|
                                                    exchange
                                                    -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                      assign [$$165] <- [get-item($$116, 0)] project: [$$165]
                                                      -- ASSIGN  |UNPARTITIONED|
                                                        aggregate [$$116] <- [listify($$181)]
                                                        -- AGGREGATE  |UNPARTITIONED|
                                                          aggregate [$$181] <- [agg-global-sql-avg($$187)]
                                                          -- AGGREGATE  |UNPARTITIONED|
                                                            exchange
                                                            -- RANDOM_MERGE_EXCHANGE  |PARTITIONED|
                                                              aggregate [$$187] <- [agg-local-sql-avg($$173)]
                                                              -- AGGREGATE  |PARTITIONED|
                                                                project ([$$173])
                                                                -- STREAM_PROJECT  |PARTITIONED|
                                                                  exchange
                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                    join (eq($$160, $$105))
                                                                    -- HYBRID_HASH_JOIN [$$105][$$160]  |PARTITIONED|
                                                                      exchange
                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                        assign [$$105] <- [substring1($$c1.getField("c_phone"), 1, 1)] project: [$$173, $$105]
                                                                        -- ASSIGN  |PARTITIONED|
                                                                          select (gt($$173, 0.0))
                                                                          -- STREAM_SELECT  |PARTITIONED|
                                                                            assign [$$173] <- [$$c1.getField("c_balance")]
                                                                            -- ASSIGN  |PARTITIONED|
                                                                              exchange
                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                replicate
                                                                                -- REPLICATE  |PARTITIONED|
                                                                                  exchange
                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                    project ([$$c1])
                                                                                    -- STREAM_PROJECT  |PARTITIONED|
                                                                                      exchange
                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                        data-scan []<-[$$157, $$c1] <- test.customer
                                                                                        -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                          exchange
                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                            empty-tuple-source
                                                                                            -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                      exchange
                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                        replicate
                                                                        -- REPLICATE  |PARTITIONED|
                                                                          exchange
                                                                          -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                                            unnest $$160 <- scan-collection(array: [ "1", "2", "3", "4", "5", "6", "7" ])
                                                                            -- UNNEST  |UNPARTITIONED|
                                                                              empty-tuple-source
                                                                              -- EMPTY_TUPLE_SOURCE  |UNPARTITIONED|
                                          exchange
                                          -- HASH_PARTITION_EXCHANGE [$$166, $$168, $$170]  |PARTITIONED|
                                            assign [$$179] <- [true]
                                            -- ASSIGN  |PARTITIONED|
                                              select (and(ge($$155, "2013-12-01 00:00:00"), le($$155, "2013-12-31 00:00:00"))) project: [$$170, $$168, $$166]
                                              -- STREAM_SELECT  |PARTITIONED|
                                                assign [$$170, $$168, $$166, $$155] <- [$$o.getField("o_w_id"), $$o.getField("o_c_id"), $$o.getField("o_d_id"), $$o.getField("o_entry_d")] project: [$$170, $$168, $$166, $$155]
                                                -- ASSIGN  |PARTITIONED|
                                                  project ([$$o])
                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                    exchange
                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                      data-scan []<-[$$158, $$o] <- test.orders
                                                      -- DATASOURCE_SCAN  |PARTITIONED|
                                                        exchange
                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                          empty-tuple-source
                                                          -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
