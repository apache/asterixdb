distribute result [$$149]
-- DISTRIBUTE_RESULT  |PARTITIONED|
  exchange
  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
    assign [$$149] <- [{"i_name": $$i_name, "brand": $#1, "i_price": $$i_price, "supplier_cnt": $$160}] project: [$$149]
    -- ASSIGN  |PARTITIONED|
      exchange
      -- SORT_MERGE_EXCHANGE [$$160(DESC) ]  |PARTITIONED|
        order (DESC, $$160)
        -- STABLE_SORT [$$160(DESC)]  |PARTITIONED|
          exchange
          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
            group by ([$$i_name := $$150; $#1 := $$151; $$i_price := $$152]) decor ([]) {
                      aggregate [$$160] <- [agg-sql-count($$171)]
                      -- AGGREGATE  |LOCAL|
                        distinct ([$$171])
                        -- MICRO_PRE_SORTED_DISTINCT_BY  |LOCAL|
                          order (ASC, $$171)
                          -- MICRO_STABLE_SORT [$$171(ASC)]  |LOCAL|
                            assign [$$171] <- [numeric-mod(numeric-multiply($$164, $$165), 10000)] project: [$$171]
                            -- ASSIGN  |LOCAL|
                              project ([$$164, $$165])
                              -- STREAM_PROJECT  |LOCAL|
                                nested tuple source
                                -- NESTED_TUPLE_SOURCE  |LOCAL|
                   }
            -- PRE_CLUSTERED_GROUP_BY[$$150, $$151, $$152]  |PARTITIONED|
              exchange
              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                order (ASC, $$150) (ASC, $$151) (ASC, $$152)
                -- STABLE_SORT [$$150(ASC), $$151(ASC), $$152(ASC)]  |PARTITIONED|
                  exchange
                  -- HASH_PARTITION_EXCHANGE [$$150, $$151, $$152]  |PARTITIONED|
                    assign [$$151] <- [substring1($$153, 1, 3)] project: [$$164, $$165, $$150, $$151, $$152]
                    -- ASSIGN  |PARTITIONED|
                      select ($$132) project: [$$150, $$152, $$153, $$165, $$164]
                      -- STREAM_SELECT  |PARTITIONED|
                        project ([$$132, $$150, $$152, $$153, $$165, $$164])
                        -- STREAM_PROJECT  |PARTITIONED|
                          exchange
                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                            group by ([$$167 := $$154; $$168 := $$155]) decor ([$$150; $$152; $$153; $$165 := $$159; $$164 := $$162]) {
                                      aggregate [$$132] <- [empty-stream()]
                                      -- AGGREGATE  |LOCAL|
                                        select (not(is-missing($$166)))
                                        -- STREAM_SELECT  |LOCAL|
                                          project ([$$166])
                                          -- STREAM_PROJECT  |LOCAL|
                                            nested tuple source
                                            -- NESTED_TUPLE_SOURCE  |LOCAL|
                                   }
                            -- PRE_CLUSTERED_GROUP_BY[$$154, $$155]  |PARTITIONED|
                              exchange
                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                order (ASC, $$154) (ASC, $$155)
                                -- STABLE_SORT [$$154(ASC), $$155(ASC)]  |PARTITIONED|
                                  exchange
                                  -- HASH_PARTITION_EXCHANGE [$$154, $$155]  |PARTITIONED|
                                    project ([$$150, $$152, $$153, $$166, $$154, $$155, $$159, $$162])
                                    -- STREAM_PROJECT  |PARTITIONED|
                                      exchange
                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                        left outer join (not(if-missing-or-null(neq(numeric-mod(numeric-multiply($$162, $$159), 10000), $$126), false)))
                                        -- NESTED_LOOP  |PARTITIONED|
                                          exchange
                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                            project ([$$150, $$152, $$153, $$154, $$155, $$159, $$162])
                                            -- STREAM_PROJECT  |PARTITIONED|
                                              exchange
                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                join (eq($$158, $$159))
                                                -- HYBRID_HASH_JOIN [$$159][$$158]  |PARTITIONED|
                                                  exchange
                                                  -- HASH_PARTITION_EXCHANGE [$$159]  |PARTITIONED|
                                                    assign [$$159, $$162] <- [$$s.getField("s_i_id"), $$s.getField("s_w_id")] project: [$$154, $$159, $$162]
                                                    -- ASSIGN  |PARTITIONED|
                                                      exchange
                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                        data-scan []<-[$$154, $$s] <- test.stock
                                                        -- DATASOURCE_SCAN  |PARTITIONED|
                                                          exchange
                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                            empty-tuple-source
                                                            -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                  exchange
                                                  -- HASH_PARTITION_EXCHANGE [$$158]  |PARTITIONED|
                                                    select (not(and(ge($$153, "zz"), lt($$153, "z{"))))
                                                    -- STREAM_SELECT  |PARTITIONED|
                                                      assign [$$152, $$150, $$153, $$158] <- [$$i.getField("i_price"), $$i.getField("i_name"), $$i.getField("i_data"), $$i.getField("i_id")] project: [$$155, $$152, $$150, $$153, $$158]
                                                      -- ASSIGN  |PARTITIONED|
                                                        exchange
                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                          data-scan []<-[$$155, $$i] <- test.item
                                                          -- DATASOURCE_SCAN  |PARTITIONED|
                                                            exchange
                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                              empty-tuple-source
                                                              -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                          exchange
                                          -- BROADCAST_EXCHANGE  |PARTITIONED|
                                            assign [$$166] <- [true]
                                            -- ASSIGN  |PARTITIONED|
                                              select (like($$su.getField("su_comment"), "%Customer%Complaints%")) project: [$$126]
                                              -- STREAM_SELECT  |PARTITIONED|
                                                assign [$$126] <- [$$su.getField("su_suppkey")]
                                                -- ASSIGN  |PARTITIONED|
                                                  project ([$$su])
                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                    exchange
                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                      data-scan []<-[$$156, $$su] <- test.supplier
                                                      -- DATASOURCE_SCAN  |PARTITIONED|
                                                        exchange
                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                          empty-tuple-source
                                                          -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
