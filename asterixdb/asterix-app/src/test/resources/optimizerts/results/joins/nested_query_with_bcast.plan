commit
-- COMMIT  |PARTITIONED|
  project ([$$37])
  -- STREAM_PROJECT  |PARTITIONED|
    exchange
    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
      insert into test.targetDataset from record: $$39 partitioned by [$$37]
      -- INSERT_DELETE  |PARTITIONED|
        exchange
        -- HASH_PARTITION_EXCHANGE [$$37]  |PARTITIONED|
          assign [$$37] <- [$$39.getField(0)]
          -- ASSIGN  |PARTITIONED|
            assign [$$39] <- [cast(check-unknown(put-autogenerated-key($$35, "tid")))] project: [$$39]
            -- ASSIGN  |PARTITIONED|
              assign [$$35] <- [{"$1": object-merge($$x, {"full-country": $$34})}] project: [$$35]
              -- ASSIGN  |PARTITIONED|
                project ([$$34, $$x])
                -- STREAM_PROJECT  |PARTITIONED|
                  exchange
                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                    group by ([$$45 := $$40]) decor ([$$x]) {
                              aggregate [$$34] <- [listify($$33)]
                              -- AGGREGATE  |LOCAL|
                                select (not(is-missing($$44)))
                                -- STREAM_SELECT  |LOCAL|
                                  project ([$$33, $$44])
                                  -- STREAM_PROJECT  |LOCAL|
                                    nested tuple source
                                    -- NESTED_TUPLE_SOURCE  |LOCAL|
                           }
                    -- PRE_CLUSTERED_GROUP_BY[$$40]  |PARTITIONED|
                      exchange
                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                        order (ASC, $$40)
                        -- STABLE_SORT [$$40(ASC)]  |PARTITIONED|
                          exchange
                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                            project ([$$x, $$33, $$44, $$40])
                            -- STREAM_PROJECT  |PARTITIONED|
                              exchange
                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                left outer join (eq($$41, $$43))
                                -- HYBRID_HASH_JOIN [$$43][$$41]  |PARTITIONED|
                                  exchange
                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                    assign [$$43] <- [$$x.getField(1)]
                                    -- ASSIGN  |PARTITIONED|
                                      exchange
                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                        data-scan []<-[$$40, $$x] <- test.tweetDataset
                                        -- DATASOURCE_SCAN  |PARTITIONED|
                                          exchange
                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                            empty-tuple-source
                                            -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                  exchange
                                  -- BROADCAST_EXCHANGE  |PARTITIONED|
                                    assign [$$44, $$33] <- [true, $$c.getField(1)] project: [$$33, $$44, $$41]
                                    -- ASSIGN  |PARTITIONED|
                                      exchange
                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                        data-scan []<-[$$41, $$c] <- test.countryDataset
                                        -- DATASOURCE_SCAN  |PARTITIONED|
                                          exchange
                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                            empty-tuple-source
                                            -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
