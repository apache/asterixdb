distribute result [$$57]
-- DISTRIBUTE_RESULT  |PARTITIONED|
  exchange
  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
    project ([$$57])
    -- STREAM_PROJECT  |PARTITIONED|
      assign [$$57] <- [{"tweetid1": $$65, "loc1": $$66, "nearby-message": $$56}]
      -- ASSIGN  |PARTITIONED|
        project ([$$56, $$65, $$66])
        -- STREAM_PROJECT  |PARTITIONED|
          exchange
          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
            order (ASC, $$74)
            -- STABLE_SORT [$$74(ASC)]  |PARTITIONED|
              exchange
              -- RANGE_PARTITION_EXCHANGE [$$74(ASC)]  |PARTITIONED|
                forward: shared-variable = $$89
                -- FORWARD  |PARTITIONED|
                  exchange
                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                    replicate
                    -- REPLICATE  |PARTITIONED|
                      exchange
                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                        group by ([$$74 := $$61]) decor ([$$65; $$66]) {
                                  aggregate [$$56] <- [listify({"tweetid2": $$68, "loc2": $$64})]
                                  -- AGGREGATE  |LOCAL|
                                    select (not(is-missing($$62)))
                                    -- STREAM_SELECT  |LOCAL|
                                      nested tuple source
                                      -- NESTED_TUPLE_SOURCE  |LOCAL|
                               }
                        -- PRE_CLUSTERED_GROUP_BY[$$61]  |PARTITIONED|
                          exchange
                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                            order (ASC, $$61) (ASC, $$67)
                            -- STABLE_SORT [$$61(ASC), $$67(ASC)]  |PARTITIONED|
                              exchange
                              -- HASH_PARTITION_EXCHANGE [$$61]  |PARTITIONED|
                                project ([$$65, $$66, $$68, $$64, $$67, $$62, $$61])
                                -- STREAM_PROJECT  |PARTITIONED|
                                  select (spatial-intersect($$64, $$n)) retain-untrue ($$62 <- missing)
                                  -- STREAM_SELECT  |PARTITIONED|
                                    project ([$$65, $$66, $$61, $$n, $$62, $$67, $$68, $$64])
                                    -- STREAM_PROJECT  |PARTITIONED|
                                      assign [$$68, $$64] <- [$$63.getField(0), $$63.getField(2)]
                                      -- ASSIGN  |PARTITIONED|
                                        project ([$$65, $$66, $$61, $$n, $$62, $$63, $$67])
                                        -- STREAM_PROJECT  |PARTITIONED|
                                          assign [$$63, $$67] <- [$$t2.getField(0), $$t2.getField("tweetid")]
                                          -- ASSIGN  |PARTITIONED|
                                            project ([$$65, $$66, $$61, $$n, $$62, $$t2])
                                            -- STREAM_PROJECT  |PARTITIONED|
                                              exchange
                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                left-outer-unnest-map [$$62, $$t2] <- index-search("TweetMessages", 0, "test", "TweetMessages", true, false, 1, $$86, 1, $$86, true, true, true)
                                                -- BTREE_SEARCH  |PARTITIONED|
                                                  exchange
                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                    order (ASC, $$86)
                                                    -- STABLE_SORT [$$86(ASC)]  |PARTITIONED|
                                                      exchange
                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                        project ([$$65, $$66, $$61, $$n, $$86])
                                                        -- STREAM_PROJECT  |PARTITIONED|
                                                          exchange
                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                            left-outer-unnest-map [$$82, $$83, $$84, $$85, $$86] <- index-search("twmSndLocIx", 1, "test", "TweetMessages", true, true, 4, $$78, $$79, $$80, $$81)
                                                            -- RTREE_SEARCH  |PARTITIONED|
                                                              exchange
                                                              -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                                assign [$$78, $$79, $$80, $$81] <- [create-mbr($$n, 2, 0), create-mbr($$n, 2, 1), create-mbr($$n, 2, 2), create-mbr($$n, 2, 3)]
                                                                -- ASSIGN  |PARTITIONED|
                                                                  assign [$$n] <- [create-circle($$66, 0.5)]
                                                                  -- ASSIGN  |PARTITIONED|
                                                                    project ([$$61, $$66, $$65])
                                                                    -- STREAM_PROJECT  |PARTITIONED|
                                                                      assign [$$66, $$65] <- [$$60.getField(2), $$60.getField(0)]
                                                                      -- ASSIGN  |PARTITIONED|
                                                                        project ([$$61, $$60])
                                                                        -- STREAM_PROJECT  |PARTITIONED|
                                                                          assign [$$60] <- [$$t1.getField(0)]
                                                                          -- ASSIGN  |PARTITIONED|
                                                                            exchange
                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                              unnest-map [$$61, $$t1] <- index-search("TweetMessages", 0, "test", "TweetMessages", false, false, 0, 1, $$75, true, false, false)
                                                                              -- BTREE_SEARCH  |PARTITIONED|
                                                                                exchange
                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                  assign [$$75] <- [10]
                                                                                  -- ASSIGN  |PARTITIONED|
                                                                                    empty-tuple-source
                                                                                    -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                  exchange
                  -- BROADCAST_EXCHANGE  |PARTITIONED|
                    aggregate [$$89] <- [agg-range-map($$87, $$88)]
                    -- AGGREGATE  |UNPARTITIONED|
                      exchange
                      -- RANDOM_MERGE_EXCHANGE  |PARTITIONED|
                        aggregate [$$87, $$88] <- [agg-local-sampling($$74), agg-null-writer($$74)]
                        -- AGGREGATE  |PARTITIONED|
                          project ([$$74])
                          -- STREAM_PROJECT  |PARTITIONED|
                            exchange
                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                              replicate
                              -- REPLICATE  |PARTITIONED|
                                exchange
                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                  group by ([$$74 := $$61]) decor ([$$65; $$66]) {
                                            aggregate [$$56] <- [listify({"tweetid2": $$68, "loc2": $$64})]
                                            -- AGGREGATE  |LOCAL|
                                              select (not(is-missing($$62)))
                                              -- STREAM_SELECT  |LOCAL|
                                                nested tuple source
                                                -- NESTED_TUPLE_SOURCE  |LOCAL|
                                         }
                                  -- PRE_CLUSTERED_GROUP_BY[$$61]  |PARTITIONED|
                                    exchange
                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                      order (ASC, $$61) (ASC, $$67)
                                      -- STABLE_SORT [$$61(ASC), $$67(ASC)]  |PARTITIONED|
                                        exchange
                                        -- HASH_PARTITION_EXCHANGE [$$61]  |PARTITIONED|
                                          project ([$$65, $$66, $$68, $$64, $$67, $$62, $$61])
                                          -- STREAM_PROJECT  |PARTITIONED|
                                            select (spatial-intersect($$64, $$n)) retain-untrue ($$62 <- missing)
                                            -- STREAM_SELECT  |PARTITIONED|
                                              project ([$$65, $$66, $$61, $$n, $$62, $$67, $$68, $$64])
                                              -- STREAM_PROJECT  |PARTITIONED|
                                                assign [$$68, $$64] <- [$$63.getField(0), $$63.getField(2)]
                                                -- ASSIGN  |PARTITIONED|
                                                  project ([$$65, $$66, $$61, $$n, $$62, $$63, $$67])
                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                    assign [$$63, $$67] <- [$$t2.getField(0), $$t2.getField("tweetid")]
                                                    -- ASSIGN  |PARTITIONED|
                                                      project ([$$65, $$66, $$61, $$n, $$62, $$t2])
                                                      -- STREAM_PROJECT  |PARTITIONED|
                                                        exchange
                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                          left-outer-unnest-map [$$62, $$t2] <- index-search("TweetMessages", 0, "test", "TweetMessages", true, false, 1, $$86, 1, $$86, true, true, true)
                                                          -- BTREE_SEARCH  |PARTITIONED|
                                                            exchange
                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                              order (ASC, $$86)
                                                              -- STABLE_SORT [$$86(ASC)]  |PARTITIONED|
                                                                exchange
                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                  project ([$$65, $$66, $$61, $$n, $$86])
                                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                                    exchange
                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                      left-outer-unnest-map [$$82, $$83, $$84, $$85, $$86] <- index-search("twmSndLocIx", 1, "test", "TweetMessages", true, true, 4, $$78, $$79, $$80, $$81)
                                                                      -- RTREE_SEARCH  |PARTITIONED|
                                                                        exchange
                                                                        -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                                          assign [$$78, $$79, $$80, $$81] <- [create-mbr($$n, 2, 0), create-mbr($$n, 2, 1), create-mbr($$n, 2, 2), create-mbr($$n, 2, 3)]
                                                                          -- ASSIGN  |PARTITIONED|
                                                                            assign [$$n] <- [create-circle($$66, 0.5)]
                                                                            -- ASSIGN  |PARTITIONED|
                                                                              project ([$$61, $$66, $$65])
                                                                              -- STREAM_PROJECT  |PARTITIONED|
                                                                                assign [$$66, $$65] <- [$$60.getField(2), $$60.getField(0)]
                                                                                -- ASSIGN  |PARTITIONED|
                                                                                  project ([$$61, $$60])
                                                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                                                    assign [$$60] <- [$$t1.getField(0)]
                                                                                    -- ASSIGN  |PARTITIONED|
                                                                                      exchange
                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                        unnest-map [$$61, $$t1] <- index-search("TweetMessages", 0, "test", "TweetMessages", false, false, 0, 1, $$75, true, false, false)
                                                                                        -- BTREE_SEARCH  |PARTITIONED|
                                                                                          exchange
                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                            assign [$$75] <- [10]
                                                                                            -- ASSIGN  |PARTITIONED|
                                                                                              empty-tuple-source
                                                                                              -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
