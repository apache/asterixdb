distribute result [$$256]
-- DISTRIBUTE_RESULT  |PARTITIONED|
  exchange
  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
    project ([$$256])
    -- STREAM_PROJECT  |PARTITIONED|
      assign [$$256] <- [{"supp_nation": $$su_nationkey, "cust_nation": $#1, "l_year": $#2, "revenue": round($$286, 2)}]
      -- ASSIGN  |PARTITIONED|
        exchange
        -- SORT_MERGE_EXCHANGE [$$su_nationkey(ASC), $#1(ASC), $#2(ASC) ]  |PARTITIONED|
          group by ([$$su_nationkey := $$310; $#1 := $$311; $#2 := $$312]) decor ([]) {
                    aggregate [$$286] <- [agg-global-sql-sum($$309)]
                    -- AGGREGATE  |LOCAL|
                      nested tuple source
                      -- NESTED_TUPLE_SOURCE  |LOCAL|
                 }
          -- SORT_GROUP_BY[$$310, $$311, $$312]  |PARTITIONED|
            exchange
            -- HASH_PARTITION_EXCHANGE [$$310, $$311, $$312]  |PARTITIONED|
              group by ([$$310 := $$262; $$311 := $$258; $$312 := $$259]) decor ([]) {
                        aggregate [$$309] <- [agg-local-sql-sum($$298)]
                        -- AGGREGATE  |LOCAL|
                          nested tuple source
                          -- NESTED_TUPLE_SOURCE  |LOCAL|
                     }
              -- SORT_GROUP_BY[$$262, $$258, $$259]  |PARTITIONED|
                exchange
                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                  project ([$$298, $$262, $$258, $$259])
                  -- STREAM_PROJECT  |PARTITIONED|
                    assign [$$259, $$258] <- [get-year(date($$294)), substring1($$270, 1, 1)]
                    -- ASSIGN  |PARTITIONED|
                      project ([$$298, $$262, $$294, $$270])
                      -- STREAM_PROJECT  |PARTITIONED|
                        select (or(and(eq($$271, "Germany"), eq($$272, "Cambodia")), and(eq($$271, "Cambodia"), eq($$272, "Germany"))))
                        -- STREAM_SELECT  |PARTITIONED|
                          project ([$$298, $$262, $$294, $$270, $$271, $$272])
                          -- STREAM_PROJECT  |PARTITIONED|
                            exchange
                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                              join (eq($$273, $$289))
                              -- HYBRID_HASH_JOIN [$$273][$$289]  |PARTITIONED|
                                exchange
                                -- HASH_PARTITION_EXCHANGE [$$273]  |PARTITIONED|
                                  project ([$$298, $$262, $$294, $$270, $$273, $$271])
                                  -- STREAM_PROJECT  |PARTITIONED|
                                    exchange
                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                      join (eq($$262, $$288))
                                      -- HYBRID_HASH_JOIN [$$262][$$288]  |PARTITIONED|
                                        exchange
                                        -- HASH_PARTITION_EXCHANGE [$$262]  |PARTITIONED|
                                          project ([$$298, $$262, $$294, $$270, $$273])
                                          -- STREAM_PROJECT  |PARTITIONED|
                                            exchange
                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                              join (eq($$284, $$285))
                                              -- HYBRID_HASH_JOIN [$$284][$$285]  |PARTITIONED|
                                                exchange
                                                -- HASH_PARTITION_EXCHANGE [$$284]  |PARTITIONED|
                                                  project ([$$298, $$294, $$270, $$273, $$284])
                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                    exchange
                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                      join (and(eq($$290, $$276), eq($$291, $$278), eq($$292, $$280)))
                                                      -- HYBRID_HASH_JOIN [$$276, $$278, $$280][$$290, $$291, $$292]  |PARTITIONED|
                                                        exchange
                                                        -- HASH_PARTITION_EXCHANGE [$$276, $$278, $$280]  |PARTITIONED|
                                                          project ([$$298, $$294, $$284, $$276, $$278, $$280])
                                                          -- STREAM_PROJECT  |PARTITIONED|
                                                            exchange
                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                              join (and(eq($$295, $$260), eq($$296, $$261)))
                                                              -- HYBRID_HASH_JOIN [$$260, $$261][$$295, $$296]  |PARTITIONED|
                                                                exchange
                                                                -- HASH_PARTITION_EXCHANGE [$$260, $$261]  |PARTITIONED|
                                                                  assign [$$284] <- [numeric-mod(numeric-multiply($$260, $$261), 10000)]
                                                                  -- ASSIGN  |PARTITIONED|
                                                                    project ([$$261, $$260])
                                                                    -- STREAM_PROJECT  |PARTITIONED|
                                                                      assign [$$261, $$260] <- [$$s.getField("s_i_id"), $$s.getField("s_w_id")]
                                                                      -- ASSIGN  |PARTITIONED|
                                                                        project ([$$s])
                                                                        -- STREAM_PROJECT  |PARTITIONED|
                                                                          exchange
                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                            data-scan []<-[$$263, $$s] <- test.stock
                                                                            -- DATASOURCE_SCAN  |PARTITIONED|
                                                                              exchange
                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                empty-tuple-source
                                                                                -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                exchange
                                                                -- HASH_PARTITION_EXCHANGE [$$295, $$296]  |PARTITIONED|
                                                                  project ([$$298, $$294, $$276, $$278, $$280, $$295, $$296])
                                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                                    select (and(ge($$269, "2017-01-01 00:00:00.000000"), le($$269, "2018-12-31 00:00:00.000000")))
                                                                    -- STREAM_SELECT  |PARTITIONED|
                                                                      project ([$$294, $$280, $$278, $$276, $$298, $$296, $$295, $$269])
                                                                      -- STREAM_PROJECT  |PARTITIONED|
                                                                        assign [$$298, $$296, $$295, $$269] <- [$$ol.getField("ol_amount"), $$ol.getField("ol_i_id"), $$ol.getField("ol_supply_w_id"), $$ol.getField("ol_delivery_d")]
                                                                        -- ASSIGN  |PARTITIONED|
                                                                          project ([$$294, $$280, $$278, $$276, $$ol])
                                                                          -- STREAM_PROJECT  |PARTITIONED|
                                                                            unnest $$ol <- scan-collection($$287)
                                                                            -- UNNEST  |PARTITIONED|
                                                                              project ([$$294, $$280, $$278, $$276, $$287])
                                                                              -- STREAM_PROJECT  |PARTITIONED|
                                                                                assign [$$294, $$280, $$278, $$276, $$287] <- [$$o.getField("o_entry_d"), $$o.getField("o_d_id"), $$o.getField("o_w_id"), $$o.getField("o_c_id"), $$o.getField("o_orderline")]
                                                                                -- ASSIGN  |PARTITIONED|
                                                                                  project ([$$o])
                                                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                                                    exchange
                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                      data-scan []<-[$$264, $$o] <- test.orders
                                                                                      -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                        exchange
                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                          empty-tuple-source
                                                                                          -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                        exchange
                                                        -- HASH_PARTITION_EXCHANGE [$$290, $$291, $$292]  |PARTITIONED|
                                                          assign [$$273] <- [get-item(string-to-codepoint($$270), 0)]
                                                          -- ASSIGN  |PARTITIONED|
                                                            project ([$$292, $$291, $$290, $$270])
                                                            -- STREAM_PROJECT  |PARTITIONED|
                                                              assign [$$292, $$291, $$290, $$270] <- [$$c.getField("c_d_id"), $$c.getField("c_w_id"), $$c.getField("c_id"), $$c.getField("c_state")]
                                                              -- ASSIGN  |PARTITIONED|
                                                                project ([$$c])
                                                                -- STREAM_PROJECT  |PARTITIONED|
                                                                  exchange
                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                    data-scan []<-[$$265, $$c] <- test.customer
                                                                    -- DATASOURCE_SCAN  |PARTITIONED|
                                                                      exchange
                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                        empty-tuple-source
                                                                        -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                exchange
                                                -- HASH_PARTITION_EXCHANGE [$$285]  |PARTITIONED|
                                                  project ([$$262, $$285])
                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                    assign [$$285, $$262] <- [$$su.getField("su_suppkey"), $$su.getField("su_nationkey")]
                                                    -- ASSIGN  |PARTITIONED|
                                                      project ([$$su])
                                                      -- STREAM_PROJECT  |PARTITIONED|
                                                        exchange
                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                          data-scan []<-[$$268, $$su] <- test.supplier
                                                          -- DATASOURCE_SCAN  |PARTITIONED|
                                                            exchange
                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                              empty-tuple-source
                                                              -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                        exchange
                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                          replicate
                                          -- REPLICATE  |PARTITIONED|
                                            exchange
                                            -- HASH_PARTITION_EXCHANGE [$$288]  |PARTITIONED|
                                              project ([$$271, $$288])
                                              -- STREAM_PROJECT  |PARTITIONED|
                                                assign [$$288, $$271] <- [$$n1.getField("n_nationkey"), $$n1.getField("n_name")]
                                                -- ASSIGN  |PARTITIONED|
                                                  project ([$$n1])
                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                    exchange
                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                      data-scan []<-[$$266, $$n1] <- test.nation
                                                      -- DATASOURCE_SCAN  |PARTITIONED|
                                                        exchange
                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                          empty-tuple-source
                                                          -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                exchange
                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                  project ([$$272, $$289])
                                  -- STREAM_PROJECT  |PARTITIONED|
                                    assign [$$272, $$289] <- [$$271, $$288]
                                    -- ASSIGN  |PARTITIONED|
                                      exchange
                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                        replicate
                                        -- REPLICATE  |PARTITIONED|
                                          exchange
                                          -- HASH_PARTITION_EXCHANGE [$$288]  |PARTITIONED|
                                            project ([$$271, $$288])
                                            -- STREAM_PROJECT  |PARTITIONED|
                                              assign [$$288, $$271] <- [$$n1.getField("n_nationkey"), $$n1.getField("n_name")]
                                              -- ASSIGN  |PARTITIONED|
                                                project ([$$n1])
                                                -- STREAM_PROJECT  |PARTITIONED|
                                                  exchange
                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                    data-scan []<-[$$266, $$n1] <- test.nation
                                                    -- DATASOURCE_SCAN  |PARTITIONED|
                                                      exchange
                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                        empty-tuple-source
                                                        -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
