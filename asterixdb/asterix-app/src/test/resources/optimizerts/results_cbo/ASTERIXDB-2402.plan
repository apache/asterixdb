distribute result [$$227]
-- DISTRIBUTE_RESULT  |PARTITIONED|
  exchange
  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
    project ([$$227])
    -- STREAM_PROJECT  |PARTITIONED|
      subplan {
                aggregate [$$227] <- [listify($$226)]
                -- AGGREGATE  |LOCAL|
                  assign [$$226] <- [{"channelExecutionTime": $$257, "result": $$258, "BrokerEndpoint": $$BrokerEndpoint}]
                  -- ASSIGN  |LOCAL|
                    group by ([$$BrokerEndpoint := $$230]) decor ([$$257 := $$259; $$258 := $$260]) {
                              aggregate [] <- []
                              -- AGGREGATE  |LOCAL|
                                nested tuple source
                                -- NESTED_TUPLE_SOURCE  |LOCAL|
                           }
                    -- MICRO_PRE_CLUSTERED_GROUP_BY[$$230]  |LOCAL|
                      order (ASC, $$230)
                      -- MICRO_STABLE_SORT [$$230(ASC)]  |LOCAL|
                        assign [$$230] <- [$$sub.getField("BrokerEndpoint")] project: [$$260, $$259, $$230]
                        -- ASSIGN  |LOCAL|
                          unnest $$sub <- scan-collection($$219) project: [$$260, $$259, $$sub]
                          -- UNNEST  |LOCAL|
                            project ([$$260, $$259, $$219])
                            -- STREAM_PROJECT  |LOCAL|
                              subplan {
                                        aggregate [$$219] <- [listify($$218)]
                                        -- AGGREGATE  |LOCAL|
                                          assign [$$218] <- [{"sub": $$sub}]
                                          -- ASSIGN  |LOCAL|
                                            unnest $$sub <- scan-collection($$256) project: [$$sub]
                                            -- UNNEST  |LOCAL|
                                              project ([$$256])
                                              -- STREAM_PROJECT  |LOCAL|
                                                nested tuple source
                                                -- NESTED_TUPLE_SOURCE  |LOCAL|
                                     }
                              -- SUBPLAN  |LOCAL|
                                project ([$$260, $$259, $$256])
                                -- STREAM_PROJECT  |LOCAL|
                                  nested tuple source
                                  -- NESTED_TUPLE_SOURCE  |LOCAL|
             }
      -- SUBPLAN  |PARTITIONED|
        project ([$$260, $$259, $$256])
        -- STREAM_PROJECT  |PARTITIONED|
          commit
          -- COMMIT  |PARTITIONED|
            project ([$$260, $$259, $$256, $$214])
            -- STREAM_PROJECT  |PARTITIONED|
              exchange
              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                insert into channels.EmergenciesNearMeChannelResults from record: $$231 partitioned by [$$214]
                -- INSERT_DELETE  |PARTITIONED|
                  exchange
                  -- HASH_PARTITION_EXCHANGE [$$214]  |PARTITIONED|
                    assign [$$260, $$259, $$256, $$214] <- [$$231.getField("result"), $$231.getField("channelExecutionTime"), $$231.getField("brokerSubIds"), $$231.getField(0)]
                    -- ASSIGN  |PARTITIONED|
                      assign [$$231] <- [cast(check-unknown(put-autogenerated-key($$212, "resultId")))] project: [$$231]
                      -- ASSIGN  |PARTITIONED|
                        assign [$$212] <- [{"result": $$result, "channelExecutionTime": current-datetime(), "channelSubId": $$266, "deliveryTime": current-datetime(), "brokerSubIds": $$211}] project: [$$212]
                        -- ASSIGN  |PARTITIONED|
                          project ([$$211, $$266, $$result])
                          -- STREAM_PROJECT  |PARTITIONED|
                            exchange
                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                              group by ([$$269 := $$267]) decor ([$$266; $$result]) {
                                        aggregate [$$211] <- [listify({"BrokerEndPoint": $$253, "brokerSubId": $$238})]
                                        -- AGGREGATE  |LOCAL|
                                          select (not(is-missing($$268)))
                                          -- STREAM_SELECT  |LOCAL|
                                            project ([$$253, $$238, $$268])
                                            -- STREAM_PROJECT  |LOCAL|
                                              nested tuple source
                                              -- NESTED_TUPLE_SOURCE  |LOCAL|
                                     }
                              -- PRE_CLUSTERED_GROUP_BY[$$267]  |PARTITIONED|
                                exchange
                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                  order (ASC, $$267)
                                  -- STABLE_SORT [$$267(ASC)]  |PARTITIONED|
                                    exchange
                                    -- HASH_PARTITION_EXCHANGE [$$267]  |PARTITIONED|
                                      project ([$$result, $$266, $$253, $$238, $$268, $$267])
                                      -- STREAM_PROJECT  |PARTITIONED|
                                        exchange
                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                          left outer join (eq($$237, $$266))
                                          -- HYBRID_HASH_JOIN [$$266][$$237]  |PARTITIONED|
                                            exchange
                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                              running-aggregate [$$267] <- [create-query-uid()]
                                              -- RUNNING_AGGREGATE  |PARTITIONED|
                                                unnest $$result <- scan-collection($$191) project: [$$result, $$266]
                                                -- UNNEST  |PARTITIONED|
                                                  exchange
                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                    group by ([$$266 := $$233]) decor ([]) {
                                                              aggregate [$$191] <- [listify({"report": $$r, "shelters": $$181})]
                                                              -- AGGREGATE  |LOCAL|
                                                                group by ([$$262 := $$234; $$263 := $$235]) decor ([$$u; $$242; $$243; $$244; $$233; $$252; $$sub; $$r]) {
                                                                          aggregate [$$181] <- [listify({"location": $$290})]
                                                                          -- AGGREGATE  |LOCAL|
                                                                            select (not(is-missing($$236)))
                                                                            -- STREAM_SELECT  |LOCAL|
                                                                              project ([$$290, $$236])
                                                                              -- STREAM_PROJECT  |LOCAL|
                                                                                nested tuple source
                                                                                -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                                       }
                                                                -- MICRO_PRE_CLUSTERED_GROUP_BY[$$234, $$235]  |LOCAL|
                                                                  select (and(not(is-missing($$264)), not(is-missing($$265))))
                                                                  -- STREAM_SELECT  |LOCAL|
                                                                    nested tuple source
                                                                    -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                           }
                                                    -- PRE_CLUSTERED_GROUP_BY[$$233]  |PARTITIONED|
                                                      exchange
                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                        order (ASC, $$233) (ASC, $$234) (ASC, $$235)
                                                        -- STABLE_SORT [$$233(ASC), $$234(ASC), $$235(ASC)]  |PARTITIONED|
                                                          exchange
                                                          -- HASH_PARTITION_EXCHANGE [$$233]  |PARTITIONED|
                                                            select ($$291) project: [$$r, $$290, $$236, $$234, $$235, $$u, $$242, $$243, $$244, $$233, $$252, $$sub, $$264, $$265]
                                                            -- STREAM_SELECT  |PARTITIONED|
                                                              project ([$$233, $$sub, $$242, $$234, $$r, $$243, $$252, $$264, $$235, $$u, $$265, $$244, $$236, $$290, $$291])
                                                              -- STREAM_PROJECT  |PARTITIONED|
                                                                window-aggregate [$$291] <- [win-mark-valid-tuple-impl($$285, $$286, $$287, $$288)] partition [$$236] order (ASC, $$285) (ASC, $$286) (ASC, $$287) (ASC, $$288)
                                                                -- WINDOW_STREAM  |PARTITIONED|
                                                                  exchange
                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                    order (ASC, $$236) (ASC, $$285) (ASC, $$286) (ASC, $$287) (ASC, $$288)
                                                                    -- STABLE_SORT [$$236(ASC), $$285(ASC), $$286(ASC), $$287(ASC), $$288(ASC)]  |PARTITIONED|
                                                                      exchange
                                                                      -- HASH_PARTITION_EXCHANGE [$$236]  |PARTITIONED|
                                                                        select (spatial-intersect($$290, $$244)) retain-untrue ($$236 <- missing)
                                                                        -- STREAM_SELECT  |PARTITIONED|
                                                                          assign [$$290] <- [create-point($$285, $$286)]
                                                                          -- ASSIGN  |PARTITIONED|
                                                                            project ([$$233, $$sub, $$242, $$234, $$r, $$243, $$252, $$264, $$235, $$u, $$265, $$244, $$285, $$286, $$287, $$288, $$236])
                                                                            -- STREAM_PROJECT  |PARTITIONED|
                                                                              exchange
                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                left-outer-unnest-map [$$285, $$286, $$287, $$288, $$236] <- index-search("s_location", 1, "Default", "channels", "Shelters", true, true, 4, $$281, $$282, $$283, $$284)
                                                                                -- RTREE_SEARCH  |PARTITIONED|
                                                                                  exchange
                                                                                  -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                                                    assign [$$281, $$282, $$283, $$284] <- [create-mbr($$244, 2, 0), create-mbr($$244, 2, 1), create-mbr($$244, 2, 2), create-mbr($$244, 2, 3)]
                                                                                    -- ASSIGN  |PARTITIONED|
                                                                                      exchange
                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                        left outer join (and(spatial-intersect($$243, $$244), eq($$235, $$242)))
                                                                                        -- HYBRID_HASH_JOIN [$$242][$$235]  |PARTITIONED|
                                                                                          exchange
                                                                                          -- HASH_PARTITION_EXCHANGE [$$242]  |PARTITIONED|
                                                                                            left outer join (true)
                                                                                            -- NESTED_LOOP  |PARTITIONED|
                                                                                              exchange
                                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                assign [$$242] <- [$$sub.getField("param0")]
                                                                                                -- ASSIGN  |PARTITIONED|
                                                                                                  exchange
                                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                    data-scan []<-[$$233, $$sub] <- channels.EmergenciesNearMeChannelChannelSubscriptions
                                                                                                    -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                      exchange
                                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                        empty-tuple-source
                                                                                                        -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                                              exchange
                                                                                              -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                                                                assign [$$264] <- [true]
                                                                                                -- ASSIGN  |PARTITIONED|
                                                                                                  select (gt($$252, numeric-subtract(current-datetime(), day_time_duration: {PT10S })))
                                                                                                  -- STREAM_SELECT  |PARTITIONED|
                                                                                                    assign [$$243, $$252] <- [$$r.getField(2), $$r.getField(3)]
                                                                                                    -- ASSIGN  |PARTITIONED|
                                                                                                      exchange
                                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                        data-scan []<-[$$234, $$r] <- channels.Reports
                                                                                                        -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                          exchange
                                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                            empty-tuple-source
                                                                                                            -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                                          exchange
                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                            assign [$$265, $$244] <- [true, $$u.getField(0)]
                                                                                            -- ASSIGN  |PARTITIONED|
                                                                                              exchange
                                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                data-scan []<-[$$235, $$u] <- channels.UserLocations
                                                                                                -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                  exchange
                                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                    empty-tuple-source
                                                                                                    -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                            exchange
                                            -- HASH_PARTITION_EXCHANGE [$$237]  |PARTITIONED|
                                              assign [$$268] <- [true]
                                              -- ASSIGN  |PARTITIONED|
                                                project ([$$238, $$237, $$253])
                                                -- STREAM_PROJECT  |PARTITIONED|
                                                  exchange
                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                    join (and(eq($$248, $$239), eq($$250, $$240)))
                                                    -- HYBRID_HASH_JOIN [$$248, $$250][$$239, $$240]  |PARTITIONED|
                                                      exchange
                                                      -- HASH_PARTITION_EXCHANGE [$$248, $$250]  |PARTITIONED|
                                                        assign [$$250, $$248] <- [$$bs.getField("BrokerName"), $$bs.getField("DataverseName")] project: [$$238, $$237, $$248, $$250]
                                                        -- ASSIGN  |PARTITIONED|
                                                          exchange
                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                            data-scan []<-[$$237, $$238, $$bs] <- channels.EmergenciesNearMeChannelBrokerSubscriptions
                                                            -- DATASOURCE_SCAN  |PARTITIONED|
                                                              exchange
                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                empty-tuple-source
                                                                -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                      exchange
                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                        assign [$$253] <- [$$b.getField("BrokerEndPoint")] project: [$$253, $$239, $$240]
                                                        -- ASSIGN  |PARTITIONED|
                                                          exchange
                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                            data-scan []<-[$$239, $$240, $$b] <- channels.Broker
                                                            -- DATASOURCE_SCAN  |PARTITIONED|
                                                              exchange
                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                empty-tuple-source
                                                                -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
