distribute result [$$253]
-- DISTRIBUTE_RESULT  |PARTITIONED|
  exchange
  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
    project ([$$253])
    -- STREAM_PROJECT  |PARTITIONED|
      subplan {
                aggregate [$$253] <- [listify($$252)]
                -- AGGREGATE  |LOCAL|
                  assign [$$252] <- [{"channelExecutionTime": $$283, "result": $$284, "BrokerEndpoint": $$BrokerEndpoint}]
                  -- ASSIGN  |LOCAL|
                    group by ([$$BrokerEndpoint := $$256]) decor ([$$283 := $$285; $$284 := $$286]) {
                              aggregate [] <- []
                              -- AGGREGATE  |LOCAL|
                                nested tuple source
                                -- NESTED_TUPLE_SOURCE  |LOCAL|
                           }
                    -- MICRO_PRE_CLUSTERED_GROUP_BY[$$256]  |LOCAL|
                      order (ASC, $$256)
                      -- MICRO_STABLE_SORT [$$256(ASC)]  |LOCAL|
                        assign [$$256] <- [$$sub.getField("BrokerEndpoint")] project: [$$286, $$285, $$256]
                        -- ASSIGN  |LOCAL|
                          unnest $$sub <- scan-collection($$245) project: [$$286, $$285, $$sub]
                          -- UNNEST  |LOCAL|
                            project ([$$286, $$285, $$245])
                            -- STREAM_PROJECT  |LOCAL|
                              subplan {
                                        aggregate [$$245] <- [listify($$244)]
                                        -- AGGREGATE  |LOCAL|
                                          assign [$$244] <- [{"sub": $$sub}]
                                          -- ASSIGN  |LOCAL|
                                            unnest $$sub <- scan-collection($$282) project: [$$sub]
                                            -- UNNEST  |LOCAL|
                                              project ([$$282])
                                              -- STREAM_PROJECT  |LOCAL|
                                                nested tuple source
                                                -- NESTED_TUPLE_SOURCE  |LOCAL|
                                     }
                              -- SUBPLAN  |LOCAL|
                                project ([$$286, $$285, $$282])
                                -- STREAM_PROJECT  |LOCAL|
                                  nested tuple source
                                  -- NESTED_TUPLE_SOURCE  |LOCAL|
             }
      -- SUBPLAN  |PARTITIONED|
        project ([$$286, $$285, $$282])
        -- STREAM_PROJECT  |PARTITIONED|
          commit
          -- COMMIT  |PARTITIONED|
            project ([$$286, $$285, $$282, $$240])
            -- STREAM_PROJECT  |PARTITIONED|
              exchange
              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                insert into channels.EmergenciesNearMeChannelResults from record: $$257 partitioned by [$$240]
                -- INSERT_DELETE  |PARTITIONED|
                  exchange
                  -- HASH_PARTITION_EXCHANGE [$$240]  |PARTITIONED|
                    assign [$$286, $$285, $$282, $$240] <- [$$257.getField("result"), $$257.getField("channelExecutionTime"), $$257.getField("brokerSubIds"), $$257.getField(0)]
                    -- ASSIGN  |PARTITIONED|
                      assign [$$257] <- [cast(check-unknown(put-autogenerated-key($$238, "resultId")))] project: [$$257]
                      -- ASSIGN  |PARTITIONED|
                        assign [$$238] <- [{"result": $$result, "channelExecutionTime": current-datetime(), "channelSubId": $$292, "deliveryTime": current-datetime(), "brokerSubIds": $$237}] project: [$$238]
                        -- ASSIGN  |PARTITIONED|
                          project ([$$237, $$292, $$result])
                          -- STREAM_PROJECT  |PARTITIONED|
                            exchange
                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                              group by ([$$295 := $$293]) decor ([$$292; $$result]) {
                                        aggregate [$$237] <- [listify({"BrokerEndPoint": $$279, "brokerSubId": $$264})]
                                        -- AGGREGATE  |LOCAL|
                                          select (not(is-missing($$294)))
                                          -- STREAM_SELECT  |LOCAL|
                                            project ([$$279, $$264, $$294])
                                            -- STREAM_PROJECT  |LOCAL|
                                              nested tuple source
                                              -- NESTED_TUPLE_SOURCE  |LOCAL|
                                     }
                              -- PRE_CLUSTERED_GROUP_BY[$$293]  |PARTITIONED|
                                exchange
                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                  order (ASC, $$293)
                                  -- STABLE_SORT [$$293(ASC)]  |PARTITIONED|
                                    exchange
                                    -- HASH_PARTITION_EXCHANGE [$$293]  |PARTITIONED|
                                      project ([$$result, $$292, $$279, $$264, $$294, $$293])
                                      -- STREAM_PROJECT  |PARTITIONED|
                                        exchange
                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                          left outer join (eq($$263, $$292))
                                          -- HYBRID_HASH_JOIN [$$292][$$263]  |PARTITIONED|
                                            exchange
                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                              running-aggregate [$$293] <- [create-query-uid()]
                                              -- RUNNING_AGGREGATE  |PARTITIONED|
                                                unnest $$result <- scan-collection($$217) project: [$$result, $$292]
                                                -- UNNEST  |PARTITIONED|
                                                  exchange
                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                    group by ([$$292 := $$259]) decor ([]) {
                                                              aggregate [$$217] <- [listify({"report": $$r, "shelters": $$207})]
                                                              -- AGGREGATE  |LOCAL|
                                                                group by ([$$288 := $$260; $$289 := $$261]) decor ([$$r; $$u; $$259; $$278; $$268; $$269; $$270; $$sub]) {
                                                                          aggregate [$$207] <- [listify({"location": $$258})]
                                                                          -- AGGREGATE  |LOCAL|
                                                                            select (not(is-missing($$262)))
                                                                            -- STREAM_SELECT  |LOCAL|
                                                                              project ([$$262, $$258])
                                                                              -- STREAM_PROJECT  |LOCAL|
                                                                                nested tuple source
                                                                                -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                                       }
                                                                -- MICRO_PRE_CLUSTERED_GROUP_BY[$$260, $$261]  |LOCAL|
                                                                  select (and(not(is-missing($$290)), not(is-missing($$291))))
                                                                  -- STREAM_SELECT  |LOCAL|
                                                                    nested tuple source
                                                                    -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                           }
                                                    -- PRE_CLUSTERED_GROUP_BY[$$259]  |PARTITIONED|
                                                      exchange
                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                        order (ASC, $$259) (ASC, $$260) (ASC, $$261)
                                                        -- STABLE_SORT [$$259(ASC), $$260(ASC), $$261(ASC)]  |PARTITIONED|
                                                          exchange
                                                          -- HASH_PARTITION_EXCHANGE [$$259]  |PARTITIONED|
                                                            select (spatial-intersect($$258, $$270)) retain-untrue ($$262 <- missing)
                                                            -- STREAM_SELECT  |PARTITIONED|
                                                              assign [$$258] <- [$$s.getField(1)] project: [$$259, $$sub, $$268, $$260, $$r, $$269, $$278, $$290, $$261, $$u, $$291, $$270, $$262, $$258]
                                                              -- ASSIGN  |PARTITIONED|
                                                                project ([$$259, $$sub, $$268, $$260, $$r, $$269, $$278, $$290, $$261, $$u, $$291, $$270, $$262, $$s])
                                                                -- STREAM_PROJECT  |PARTITIONED|
                                                                  exchange
                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                    left-outer-unnest-map [$$262, $$s] <- index-search("Shelters", 0, "Default", "channels", "Shelters", true, false, 1, $$315, 1, $$315, true, true, true)
                                                                    -- BTREE_SEARCH  |PARTITIONED|
                                                                      exchange
                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                        order (ASC, $$315)
                                                                        -- STABLE_SORT [$$315(ASC)]  |PARTITIONED|
                                                                          exchange
                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                            project ([$$259, $$sub, $$268, $$260, $$r, $$269, $$278, $$290, $$261, $$u, $$291, $$270, $$315])
                                                                            -- STREAM_PROJECT  |PARTITIONED|
                                                                              exchange
                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                left-outer-unnest-map [$$311, $$312, $$313, $$314, $$315] <- index-search("s_location", 1, "Default", "channels", "Shelters", true, true, 4, $$307, $$308, $$309, $$310)
                                                                                -- RTREE_SEARCH  |PARTITIONED|
                                                                                  exchange
                                                                                  -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                                                    assign [$$307, $$308, $$309, $$310] <- [create-mbr($$270, 2, 0), create-mbr($$270, 2, 1), create-mbr($$270, 2, 2), create-mbr($$270, 2, 3)]
                                                                                    -- ASSIGN  |PARTITIONED|
                                                                                      exchange
                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                        left outer join (and(spatial-intersect($$269, $$270), eq($$261, $$268)))
                                                                                        -- HYBRID_HASH_JOIN [$$268][$$261]  |PARTITIONED|
                                                                                          exchange
                                                                                          -- HASH_PARTITION_EXCHANGE [$$268]  |PARTITIONED|
                                                                                            left outer join (true)
                                                                                            -- NESTED_LOOP  |PARTITIONED|
                                                                                              exchange
                                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                assign [$$268] <- [$$sub.getField("param0")]
                                                                                                -- ASSIGN  |PARTITIONED|
                                                                                                  exchange
                                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                    data-scan []<-[$$259, $$sub] <- channels.EmergenciesNearMeChannelChannelSubscriptions
                                                                                                    -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                      exchange
                                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                        empty-tuple-source
                                                                                                        -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                                              exchange
                                                                                              -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                                                                assign [$$290] <- [true]
                                                                                                -- ASSIGN  |PARTITIONED|
                                                                                                  select (gt($$278, numeric-subtract(current-datetime(), day_time_duration: {PT10S })))
                                                                                                  -- STREAM_SELECT  |PARTITIONED|
                                                                                                    assign [$$269, $$278] <- [$$r.getField(2), $$r.getField(3)]
                                                                                                    -- ASSIGN  |PARTITIONED|
                                                                                                      exchange
                                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                        data-scan []<-[$$260, $$r] <- channels.Reports
                                                                                                        -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                          exchange
                                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                            empty-tuple-source
                                                                                                            -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                                          exchange
                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                            assign [$$291, $$270] <- [true, $$u.getField(0)]
                                                                                            -- ASSIGN  |PARTITIONED|
                                                                                              exchange
                                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                data-scan []<-[$$261, $$u] <- channels.UserLocations
                                                                                                -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                  exchange
                                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                    empty-tuple-source
                                                                                                    -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                            exchange
                                            -- HASH_PARTITION_EXCHANGE [$$263]  |PARTITIONED|
                                              assign [$$294] <- [true]
                                              -- ASSIGN  |PARTITIONED|
                                                project ([$$264, $$263, $$279])
                                                -- STREAM_PROJECT  |PARTITIONED|
                                                  exchange
                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                    join (and(eq($$274, $$265), eq($$276, $$266)))
                                                    -- HYBRID_HASH_JOIN [$$274, $$276][$$265, $$266]  |PARTITIONED|
                                                      exchange
                                                      -- HASH_PARTITION_EXCHANGE [$$274, $$276]  |PARTITIONED|
                                                        assign [$$276, $$274] <- [$$bs.getField("BrokerName"), $$bs.getField("DataverseName")] project: [$$264, $$263, $$274, $$276]
                                                        -- ASSIGN  |PARTITIONED|
                                                          exchange
                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                            data-scan []<-[$$263, $$264, $$bs] <- channels.EmergenciesNearMeChannelBrokerSubscriptions
                                                            -- DATASOURCE_SCAN  |PARTITIONED|
                                                              exchange
                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                empty-tuple-source
                                                                -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                      exchange
                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                        assign [$$279] <- [$$b.getField("BrokerEndPoint")] project: [$$279, $$265, $$266]
                                                        -- ASSIGN  |PARTITIONED|
                                                          exchange
                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                            data-scan []<-[$$265, $$266, $$b] <- channels.Broker
                                                            -- DATASOURCE_SCAN  |PARTITIONED|
                                                              exchange
                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                empty-tuple-source
                                                                -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
