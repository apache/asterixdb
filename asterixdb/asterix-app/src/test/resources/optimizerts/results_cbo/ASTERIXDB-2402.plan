distribute result [$$237]
-- DISTRIBUTE_RESULT  |PARTITIONED|
  exchange
  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
    project ([$$237])
    -- STREAM_PROJECT  |PARTITIONED|
      subplan {
                aggregate [$$237] <- [listify($$236)]
                -- AGGREGATE  |LOCAL|
                  assign [$$236] <- [{"channelExecutionTime": $$267, "result": $$268, "BrokerEndpoint": $$BrokerEndpoint}]
                  -- ASSIGN  |LOCAL|
                    group by ([$$BrokerEndpoint := $$240]) decor ([$$267 := $$269; $$268 := $$270]) {
                              aggregate [] <- []
                              -- AGGREGATE  |LOCAL|
                                nested tuple source
                                -- NESTED_TUPLE_SOURCE  |LOCAL|
                           }
                    -- MICRO_PRE_CLUSTERED_GROUP_BY[$$240]  |LOCAL|
                      order (ASC, $$240)
                      -- MICRO_STABLE_SORT [$$240(ASC)]  |LOCAL|
                        assign [$$240] <- [$$sub.getField("BrokerEndpoint")] project: [$$270, $$269, $$240]
                        -- ASSIGN  |LOCAL|
                          unnest $$sub <- scan-collection($$229) project: [$$270, $$269, $$sub]
                          -- UNNEST  |LOCAL|
                            project ([$$270, $$269, $$229])
                            -- STREAM_PROJECT  |LOCAL|
                              subplan {
                                        aggregate [$$229] <- [listify($$228)]
                                        -- AGGREGATE  |LOCAL|
                                          assign [$$228] <- [{"sub": $$sub}]
                                          -- ASSIGN  |LOCAL|
                                            unnest $$sub <- scan-collection($$266) project: [$$sub]
                                            -- UNNEST  |LOCAL|
                                              project ([$$266])
                                              -- STREAM_PROJECT  |LOCAL|
                                                nested tuple source
                                                -- NESTED_TUPLE_SOURCE  |LOCAL|
                                     }
                              -- SUBPLAN  |LOCAL|
                                project ([$$270, $$269, $$266])
                                -- STREAM_PROJECT  |LOCAL|
                                  nested tuple source
                                  -- NESTED_TUPLE_SOURCE  |LOCAL|
             }
      -- SUBPLAN  |PARTITIONED|
        project ([$$270, $$269, $$266])
        -- STREAM_PROJECT  |PARTITIONED|
          commit
          -- COMMIT  |PARTITIONED|
            project ([$$270, $$269, $$266, $$224])
            -- STREAM_PROJECT  |PARTITIONED|
              exchange
              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                insert into channels.EmergenciesNearMeChannelResults from record: $$241 partitioned by [$$224]
                -- INSERT_DELETE  |PARTITIONED|
                  exchange
                  -- HASH_PARTITION_EXCHANGE [$$224]  |PARTITIONED|
                    assign [$$270, $$269, $$266, $$224] <- [$$241.getField("result"), $$241.getField("channelExecutionTime"), $$241.getField("brokerSubIds"), $$241.getField(0)]
                    -- ASSIGN  |PARTITIONED|
                      assign [$$241] <- [cast(check-unknown(put-autogenerated-key($$222, "resultId")))] project: [$$241]
                      -- ASSIGN  |PARTITIONED|
                        assign [$$222] <- [{"result": $$result, "channelExecutionTime": current-datetime(), "channelSubId": $$276, "deliveryTime": current-datetime(), "brokerSubIds": $$221}] project: [$$222]
                        -- ASSIGN  |PARTITIONED|
                          project ([$$221, $$276, $$result])
                          -- STREAM_PROJECT  |PARTITIONED|
                            exchange
                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                              group by ([$$279 := $$277]) decor ([$$276; $$result]) {
                                        aggregate [$$221] <- [listify({"BrokerEndPoint": $$263, "brokerSubId": $$248})]
                                        -- AGGREGATE  |LOCAL|
                                          select (not(is-missing($$278)))
                                          -- STREAM_SELECT  |LOCAL|
                                            project ([$$263, $$248, $$278])
                                            -- STREAM_PROJECT  |LOCAL|
                                              nested tuple source
                                              -- NESTED_TUPLE_SOURCE  |LOCAL|
                                     }
                              -- PRE_CLUSTERED_GROUP_BY[$$277]  |PARTITIONED|
                                exchange
                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                  order (ASC, $$277)
                                  -- STABLE_SORT [$$277(ASC)]  |PARTITIONED|
                                    exchange
                                    -- HASH_PARTITION_EXCHANGE [$$277]  |PARTITIONED|
                                      project ([$$result, $$276, $$263, $$248, $$278, $$277])
                                      -- STREAM_PROJECT  |PARTITIONED|
                                        exchange
                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                          left outer join (eq($$247, $$276))
                                          -- HYBRID_HASH_JOIN [$$276][$$247]  |PARTITIONED|
                                            exchange
                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                              running-aggregate [$$277] <- [create-query-uid()]
                                              -- RUNNING_AGGREGATE  |PARTITIONED|
                                                unnest $$result <- scan-collection($$201) project: [$$result, $$276]
                                                -- UNNEST  |PARTITIONED|
                                                  exchange
                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                    group by ([$$276 := $$243]) decor ([]) {
                                                              aggregate [$$201] <- [listify({"report": $$r, "shelters": $$191})]
                                                              -- AGGREGATE  |LOCAL|
                                                                group by ([$$272 := $$244; $$273 := $$245]) decor ([$$243; $$262; $$sub; $$r; $$u; $$252; $$253; $$254]) {
                                                                          aggregate [$$191] <- [listify({"location": $$242})]
                                                                          -- AGGREGATE  |LOCAL|
                                                                            select (not(is-missing($$246)))
                                                                            -- STREAM_SELECT  |LOCAL|
                                                                              project ([$$246, $$242])
                                                                              -- STREAM_PROJECT  |LOCAL|
                                                                                nested tuple source
                                                                                -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                                       }
                                                                -- MICRO_PRE_CLUSTERED_GROUP_BY[$$244, $$245]  |LOCAL|
                                                                  select (and(not(is-missing($$274)), not(is-missing($$275))))
                                                                  -- STREAM_SELECT  |LOCAL|
                                                                    nested tuple source
                                                                    -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                           }
                                                    -- PRE_CLUSTERED_GROUP_BY[$$243]  |PARTITIONED|
                                                      exchange
                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                        order (ASC, $$243) (ASC, $$244) (ASC, $$245)
                                                        -- STABLE_SORT [$$243(ASC), $$244(ASC), $$245(ASC)]  |PARTITIONED|
                                                          exchange
                                                          -- HASH_PARTITION_EXCHANGE [$$243]  |PARTITIONED|
                                                            select (spatial-intersect($$242, $$254)) retain-untrue ($$246 <- missing)
                                                            -- STREAM_SELECT  |PARTITIONED|
                                                              assign [$$242] <- [$$s.getField(1)] project: [$$243, $$sub, $$252, $$244, $$r, $$253, $$262, $$274, $$245, $$u, $$275, $$254, $$246, $$242]
                                                              -- ASSIGN  |PARTITIONED|
                                                                project ([$$243, $$sub, $$252, $$244, $$r, $$253, $$262, $$274, $$245, $$u, $$275, $$254, $$246, $$s])
                                                                -- STREAM_PROJECT  |PARTITIONED|
                                                                  exchange
                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                    left-outer-unnest-map [$$246, $$s] <- index-search("Shelters", 0, "Default", "channels", "Shelters", true, false, 1, $$299, 1, $$299, true, true, true)
                                                                    -- BTREE_SEARCH  |PARTITIONED|
                                                                      exchange
                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                        order (ASC, $$299)
                                                                        -- STABLE_SORT [$$299(ASC)]  |PARTITIONED|
                                                                          exchange
                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                            project ([$$243, $$sub, $$252, $$244, $$r, $$253, $$262, $$274, $$245, $$u, $$275, $$254, $$299])
                                                                            -- STREAM_PROJECT  |PARTITIONED|
                                                                              exchange
                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                left-outer-unnest-map [$$295, $$296, $$297, $$298, $$299] <- index-search("s_location", 1, "Default", "channels", "Shelters", true, true, 4, $$291, $$292, $$293, $$294)
                                                                                -- RTREE_SEARCH  |PARTITIONED|
                                                                                  exchange
                                                                                  -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                                                    assign [$$291, $$292, $$293, $$294] <- [create-mbr($$254, 2, 0), create-mbr($$254, 2, 1), create-mbr($$254, 2, 2), create-mbr($$254, 2, 3)]
                                                                                    -- ASSIGN  |PARTITIONED|
                                                                                      exchange
                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                        left outer join (and(spatial-intersect($$253, $$254), eq($$245, $$252)))
                                                                                        -- HYBRID_HASH_JOIN [$$252][$$245]  |PARTITIONED|
                                                                                          exchange
                                                                                          -- HASH_PARTITION_EXCHANGE [$$252]  |PARTITIONED|
                                                                                            left outer join (true)
                                                                                            -- NESTED_LOOP  |PARTITIONED|
                                                                                              exchange
                                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                assign [$$252] <- [$$sub.getField("param0")]
                                                                                                -- ASSIGN  |PARTITIONED|
                                                                                                  exchange
                                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                    data-scan []<-[$$243, $$sub] <- channels.EmergenciesNearMeChannelChannelSubscriptions
                                                                                                    -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                      exchange
                                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                        empty-tuple-source
                                                                                                        -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                                              exchange
                                                                                              -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                                                                assign [$$274] <- [true]
                                                                                                -- ASSIGN  |PARTITIONED|
                                                                                                  select (gt($$262, numeric-subtract(current-datetime(), day_time_duration: {PT10S })))
                                                                                                  -- STREAM_SELECT  |PARTITIONED|
                                                                                                    assign [$$253, $$262] <- [$$r.getField(2), $$r.getField(3)]
                                                                                                    -- ASSIGN  |PARTITIONED|
                                                                                                      exchange
                                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                        data-scan []<-[$$244, $$r] <- channels.Reports
                                                                                                        -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                          exchange
                                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                            empty-tuple-source
                                                                                                            -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                                          exchange
                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                            assign [$$275, $$254] <- [true, $$u.getField(0)]
                                                                                            -- ASSIGN  |PARTITIONED|
                                                                                              exchange
                                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                data-scan []<-[$$245, $$u] <- channels.UserLocations
                                                                                                -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                  exchange
                                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                    empty-tuple-source
                                                                                                    -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                            exchange
                                            -- HASH_PARTITION_EXCHANGE [$$247]  |PARTITIONED|
                                              assign [$$278] <- [true]
                                              -- ASSIGN  |PARTITIONED|
                                                project ([$$248, $$247, $$263])
                                                -- STREAM_PROJECT  |PARTITIONED|
                                                  exchange
                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                    join (and(eq($$258, $$249), eq($$260, $$250)))
                                                    -- HYBRID_HASH_JOIN [$$258, $$260][$$249, $$250]  |PARTITIONED|
                                                      exchange
                                                      -- HASH_PARTITION_EXCHANGE [$$258, $$260]  |PARTITIONED|
                                                        assign [$$260, $$258] <- [$$bs.getField("BrokerName"), $$bs.getField("DataverseName")] project: [$$248, $$247, $$258, $$260]
                                                        -- ASSIGN  |PARTITIONED|
                                                          exchange
                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                            data-scan []<-[$$247, $$248, $$bs] <- channels.EmergenciesNearMeChannelBrokerSubscriptions
                                                            -- DATASOURCE_SCAN  |PARTITIONED|
                                                              exchange
                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                empty-tuple-source
                                                                -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                      exchange
                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                        assign [$$263] <- [$$b.getField("BrokerEndPoint")] project: [$$263, $$249, $$250]
                                                        -- ASSIGN  |PARTITIONED|
                                                          exchange
                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                            data-scan []<-[$$249, $$250, $$b] <- channels.Broker
                                                            -- DATASOURCE_SCAN  |PARTITIONED|
                                                              exchange
                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                empty-tuple-source
                                                                -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
