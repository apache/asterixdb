distribute result [$$227]
-- DISTRIBUTE_RESULT  |PARTITIONED|
  exchange
  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
    project ([$$227])
    -- STREAM_PROJECT  |PARTITIONED|
      subplan {
                aggregate [$$227] <- [listify($$226)]
                -- AGGREGATE  |LOCAL|
                  assign [$$226] <- [{"channelExecutionTime": $$257, "result": $$258, "BrokerEndpoint": $$BrokerEndpoint}]
                  -- ASSIGN  |LOCAL|
                    group by ([$$BrokerEndpoint := $$230]) decor ([$$257 := $$259; $$258 := $$260]) {
                              aggregate [] <- []
                              -- AGGREGATE  |LOCAL|
                                nested tuple source
                                -- NESTED_TUPLE_SOURCE  |LOCAL|
                           }
                    -- MICRO_PRE_CLUSTERED_GROUP_BY[$$230]  |LOCAL|
                      order (ASC, $$230)
                      -- MICRO_STABLE_SORT [$$230(ASC)]  |LOCAL|
                        assign [$$230] <- [$$sub.getField("BrokerEndpoint")]
                        -- ASSIGN  |LOCAL|
                          unnest $$sub <- scan-collection($$219)
                          -- UNNEST  |LOCAL|
                            subplan {
                                      aggregate [$$219] <- [listify($$218)]
                                      -- AGGREGATE  |LOCAL|
                                        assign [$$218] <- [{"sub": $$sub}]
                                        -- ASSIGN  |LOCAL|
                                          unnest $$sub <- scan-collection($$256)
                                          -- UNNEST  |LOCAL|
                                            nested tuple source
                                            -- NESTED_TUPLE_SOURCE  |LOCAL|
                                   }
                            -- SUBPLAN  |LOCAL|
                              nested tuple source
                              -- NESTED_TUPLE_SOURCE  |LOCAL|
             }
      -- SUBPLAN  |PARTITIONED|
        project ([$$260, $$259, $$256])
        -- STREAM_PROJECT  |PARTITIONED|
          commit
          -- COMMIT  |PARTITIONED|
            project ([$$260, $$259, $$256, $$214])
            -- STREAM_PROJECT  |PARTITIONED|
              exchange
              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                insert into channels.EmergenciesNearMeChannelResults from record: $$231 partitioned by [$$214]
                -- INSERT_DELETE  |PARTITIONED|
                  exchange
                  -- HASH_PARTITION_EXCHANGE [$$214]  |PARTITIONED|
                    assign [$$260, $$259, $$256, $$214] <- [$$231.getField("result"), $$231.getField("channelExecutionTime"), $$231.getField("brokerSubIds"), $$231.getField(0)]
                    -- ASSIGN  |PARTITIONED|
                      assign [$$231] <- [cast(check-unknown(put-autogenerated-key($$212, "resultId")))] project: [$$231]
                      -- ASSIGN  |PARTITIONED|
                        assign [$$212] <- [{"result": $$result, "channelExecutionTime": current-datetime(), "channelSubId": $$266, "deliveryTime": current-datetime(), "brokerSubIds": $$211}] project: [$$212]
                        -- ASSIGN  |PARTITIONED|
                          project ([$$211, $$266, $$result])
                          -- STREAM_PROJECT  |PARTITIONED|
                            exchange
                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                              group by ([$$269 := $$267]) decor ([$$266; $$result]) {
                                        aggregate [$$211] <- [listify({"BrokerEndPoint": $$253, "brokerSubId": $$238})]
                                        -- AGGREGATE  |LOCAL|
                                          select (not(is-missing($$268)))
                                          -- STREAM_SELECT  |LOCAL|
                                            nested tuple source
                                            -- NESTED_TUPLE_SOURCE  |LOCAL|
                                     }
                              -- PRE_CLUSTERED_GROUP_BY[$$267]  |PARTITIONED|
                                exchange
                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                  order (ASC, $$267)
                                  -- STABLE_SORT [$$267(ASC)]  |PARTITIONED|
                                    exchange
                                    -- HASH_PARTITION_EXCHANGE [$$267]  |PARTITIONED|
                                      project ([$$result, $$266, $$253, $$238, $$268, $$267])
                                      -- STREAM_PROJECT  |PARTITIONED|
                                        exchange
                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                          left outer join (eq($$237, $$266))
                                          -- HYBRID_HASH_JOIN [$$266][$$237]  |PARTITIONED|
                                            exchange
                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                              running-aggregate [$$267] <- [create-query-uid()]
                                              -- RUNNING_AGGREGATE  |PARTITIONED|
                                                unnest $$result <- scan-collection($$191) project: [$$result, $$266]
                                                -- UNNEST  |PARTITIONED|
                                                  exchange
                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                    group by ([$$266 := $$319]) decor ([]) {
                                                              aggregate [$$191] <- [listify({"report": $$328, "shelters": $$181})]
                                                              -- AGGREGATE  |LOCAL|
                                                                group by ([$$262 := $$321; $$263 := $$322]) decor ([$$317; $$323; $$324; $$325; $$319; $$326; $$327; $$328]) {
                                                                          aggregate [$$181] <- [listify({"location": $$232})]
                                                                          -- AGGREGATE  |LOCAL|
                                                                            select (not(is-missing($$236)))
                                                                            -- STREAM_SELECT  |LOCAL|
                                                                              nested tuple source
                                                                              -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                                       }
                                                                -- MICRO_PRE_CLUSTERED_GROUP_BY[$$321, $$322]  |LOCAL|
                                                                  select (and(not(is-missing($$318)), not(is-missing($$320))))
                                                                  -- STREAM_SELECT  |LOCAL|
                                                                    nested tuple source
                                                                    -- NESTED_TUPLE_SOURCE  |LOCAL|
                                                           }
                                                    -- PRE_CLUSTERED_GROUP_BY[$$319]  |PARTITIONED|
                                                      exchange
                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                        order (ASC, $$319) (ASC, $$321) (ASC, $$322)
                                                        -- STABLE_SORT [$$319(ASC), $$321(ASC), $$322(ASC)]  |PARTITIONED|
                                                          exchange
                                                          -- HASH_PARTITION_EXCHANGE [$$319]  |PARTITIONED|
                                                            union ($$316, $$291, $$232) ($$u, $$u, $$317) ($$264, $$264, $$318) ($$233, $$233, $$319) ($$265, $$265, $$320) ($$234, $$234, $$321) ($$235, $$235, $$322) ($$242, $$242, $$323) ($$243, $$243, $$324) ($$244, $$244, $$325) ($$252, $$252, $$326) ($$sub, $$sub, $$327) ($$r, $$r, $$328) ($$314, $$289, $$236)
                                                            -- UNION_ALL  |PARTITIONED|
                                                              exchange
                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                select (spatial-intersect($$316, $$244)) retain-untrue ($$314 <- missing) project: [$$316, $$u, $$264, $$233, $$265, $$234, $$235, $$242, $$243, $$244, $$252, $$sub, $$r, $$314]
                                                                -- STREAM_SELECT  |PARTITIONED|
                                                                  assign [$$316] <- [$$315.getField(1)] project: [$$233, $$sub, $$242, $$234, $$r, $$243, $$252, $$264, $$235, $$u, $$265, $$244, $$289, $$314, $$316]
                                                                  -- ASSIGN  |PARTITIONED|
                                                                    exchange
                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                      left-outer-unnest-map [$$314, $$315] <- index-search("Shelters", 0, "Default", "channels", "Shelters", true, false, 1, $$289, 1, $$289, true, true, true)
                                                                      -- BTREE_SEARCH  |PARTITIONED|
                                                                        exchange
                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                          project ([$$233, $$sub, $$242, $$234, $$r, $$243, $$252, $$264, $$235, $$u, $$265, $$244, $$289])
                                                                          -- STREAM_PROJECT  |PARTITIONED|
                                                                            exchange
                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                              split ($$290)
                                                                              -- SPLIT  |PARTITIONED|
                                                                                exchange
                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                  project ([$$233, $$sub, $$242, $$234, $$r, $$243, $$252, $$264, $$235, $$u, $$265, $$244, $$285, $$286, $$289, $$290])
                                                                                  -- STREAM_PROJECT  |PARTITIONED|
                                                                                    exchange
                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                      left-outer-unnest-map [$$285, $$286, $$287, $$288, $$289, $$290] <- index-search("s_location", 1, "Default", "channels", "Shelters", true, true, 4, $$281, $$282, $$283, $$284)
                                                                                      -- RTREE_SEARCH  |PARTITIONED|
                                                                                        exchange
                                                                                        -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                                                          assign [$$281, $$282, $$283, $$284] <- [create-mbr($$244, 2, 0), create-mbr($$244, 2, 1), create-mbr($$244, 2, 2), create-mbr($$244, 2, 3)]
                                                                                          -- ASSIGN  |PARTITIONED|
                                                                                            exchange
                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                              left outer join (and(spatial-intersect($$243, $$244), eq($$235, $$242)))
                                                                                              -- HYBRID_HASH_JOIN [$$242][$$235]  |PARTITIONED|
                                                                                                exchange
                                                                                                -- HASH_PARTITION_EXCHANGE [$$242]  |PARTITIONED|
                                                                                                  left outer join (true)
                                                                                                  -- NESTED_LOOP  |PARTITIONED|
                                                                                                    exchange
                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                      assign [$$242] <- [$$sub.getField("param0")]
                                                                                                      -- ASSIGN  |PARTITIONED|
                                                                                                        exchange
                                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                          data-scan []<-[$$233, $$sub] <- channels.EmergenciesNearMeChannelChannelSubscriptions
                                                                                                          -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                            exchange
                                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                              empty-tuple-source
                                                                                                              -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                                                    exchange
                                                                                                    -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                                                                      assign [$$264] <- [true]
                                                                                                      -- ASSIGN  |PARTITIONED|
                                                                                                        select (gt($$252, numeric-subtract(current-datetime(), day_time_duration: {PT10S })))
                                                                                                        -- STREAM_SELECT  |PARTITIONED|
                                                                                                          assign [$$243, $$252] <- [$$r.getField(2), $$r.getField(3)]
                                                                                                          -- ASSIGN  |PARTITIONED|
                                                                                                            exchange
                                                                                                            -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                              data-scan []<-[$$234, $$r] <- channels.Reports
                                                                                                              -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                                exchange
                                                                                                                -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                                  empty-tuple-source
                                                                                                                  -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                                                exchange
                                                                                                -- HASH_PARTITION_EXCHANGE [$$235]  |PARTITIONED|
                                                                                                  assign [$$265, $$244] <- [true, $$u.getField(0)]
                                                                                                  -- ASSIGN  |PARTITIONED|
                                                                                                    exchange
                                                                                                    -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                      data-scan []<-[$$235, $$u] <- channels.UserLocations
                                                                                                      -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                        exchange
                                                                                                        -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                          empty-tuple-source
                                                                                                          -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                              exchange
                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                select (spatial-intersect($$291, $$244)) retain-untrue ($$236 <- missing) project: [$$291, $$u, $$264, $$233, $$265, $$234, $$235, $$242, $$243, $$244, $$252, $$sub, $$r, $$289]
                                                                -- STREAM_SELECT  |PARTITIONED|
                                                                  assign [$$291] <- [create-point($$285, $$286)] project: [$$233, $$sub, $$242, $$234, $$r, $$243, $$252, $$264, $$235, $$u, $$265, $$244, $$289, $$291]
                                                                  -- ASSIGN  |PARTITIONED|
                                                                    project ([$$233, $$sub, $$242, $$234, $$r, $$243, $$252, $$264, $$235, $$u, $$265, $$244, $$285, $$286, $$289])
                                                                    -- STREAM_PROJECT  |PARTITIONED|
                                                                      exchange
                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                        split ($$290)
                                                                        -- SPLIT  |PARTITIONED|
                                                                          exchange
                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                            project ([$$233, $$sub, $$242, $$234, $$r, $$243, $$252, $$264, $$235, $$u, $$265, $$244, $$285, $$286, $$289, $$290])
                                                                            -- STREAM_PROJECT  |PARTITIONED|
                                                                              exchange
                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                left-outer-unnest-map [$$285, $$286, $$287, $$288, $$289, $$290] <- index-search("s_location", 1, "Default", "channels", "Shelters", true, true, 4, $$281, $$282, $$283, $$284)
                                                                                -- RTREE_SEARCH  |PARTITIONED|
                                                                                  exchange
                                                                                  -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                                                    assign [$$281, $$282, $$283, $$284] <- [create-mbr($$244, 2, 0), create-mbr($$244, 2, 1), create-mbr($$244, 2, 2), create-mbr($$244, 2, 3)]
                                                                                    -- ASSIGN  |PARTITIONED|
                                                                                      exchange
                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                        left outer join (and(spatial-intersect($$243, $$244), eq($$235, $$242)))
                                                                                        -- HYBRID_HASH_JOIN [$$242][$$235]  |PARTITIONED|
                                                                                          exchange
                                                                                          -- HASH_PARTITION_EXCHANGE [$$242]  |PARTITIONED|
                                                                                            left outer join (true)
                                                                                            -- NESTED_LOOP  |PARTITIONED|
                                                                                              exchange
                                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                assign [$$242] <- [$$sub.getField("param0")]
                                                                                                -- ASSIGN  |PARTITIONED|
                                                                                                  exchange
                                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                    data-scan []<-[$$233, $$sub] <- channels.EmergenciesNearMeChannelChannelSubscriptions
                                                                                                    -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                      exchange
                                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                        empty-tuple-source
                                                                                                        -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                                              exchange
                                                                                              -- BROADCAST_EXCHANGE  |PARTITIONED|
                                                                                                assign [$$264] <- [true]
                                                                                                -- ASSIGN  |PARTITIONED|
                                                                                                  select (gt($$252, numeric-subtract(current-datetime(), day_time_duration: {PT10S })))
                                                                                                  -- STREAM_SELECT  |PARTITIONED|
                                                                                                    assign [$$243, $$252] <- [$$r.getField(2), $$r.getField(3)]
                                                                                                    -- ASSIGN  |PARTITIONED|
                                                                                                      exchange
                                                                                                      -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                        data-scan []<-[$$234, $$r] <- channels.Reports
                                                                                                        -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                          exchange
                                                                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                            empty-tuple-source
                                                                                                            -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                                                          exchange
                                                                                          -- HASH_PARTITION_EXCHANGE [$$235]  |PARTITIONED|
                                                                                            assign [$$265, $$244] <- [true, $$u.getField(0)]
                                                                                            -- ASSIGN  |PARTITIONED|
                                                                                              exchange
                                                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                data-scan []<-[$$235, $$u] <- channels.UserLocations
                                                                                                -- DATASOURCE_SCAN  |PARTITIONED|
                                                                                                  exchange
                                                                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                                                    empty-tuple-source
                                                                                                    -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                            exchange
                                            -- HASH_PARTITION_EXCHANGE [$$237]  |PARTITIONED|
                                              assign [$$268] <- [true]
                                              -- ASSIGN  |PARTITIONED|
                                                project ([$$238, $$237, $$253])
                                                -- STREAM_PROJECT  |PARTITIONED|
                                                  exchange
                                                  -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                    join (and(eq($$248, $$239), eq($$250, $$240))) [cardinality: 1000000.0, op-cost: 2000000.0, total-cost: 6000000.0]
                                                    -- HYBRID_HASH_JOIN [$$248, $$250][$$239, $$240]  |PARTITIONED|
                                                      exchange
                                                      -- HASH_PARTITION_EXCHANGE [$$248, $$250]  |PARTITIONED|
                                                        assign [$$250, $$248] <- [$$bs.getField("BrokerName"), $$bs.getField("DataverseName")] project: [$$238, $$237, $$248, $$250]
                                                        -- ASSIGN  |PARTITIONED|
                                                          exchange
                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                            data-scan []<-[$$237, $$238, $$bs] <- channels.EmergenciesNearMeChannelBrokerSubscriptions [cardinality: 1000000.0, op-cost: 1000000.0, total-cost: 1000000.0]
                                                            -- DATASOURCE_SCAN  |PARTITIONED|
                                                              exchange
                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                empty-tuple-source
                                                                -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
                                                      exchange
                                                      -- HASH_PARTITION_EXCHANGE [$$239, $$240]  |PARTITIONED|
                                                        assign [$$253] <- [$$b.getField("BrokerEndPoint")] project: [$$253, $$239, $$240]
                                                        -- ASSIGN  |PARTITIONED|
                                                          exchange
                                                          -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                            data-scan []<-[$$239, $$240, $$b] <- channels.Broker [cardinality: 1000000.0, op-cost: 1000000.0, total-cost: 1000000.0]
                                                            -- DATASOURCE_SCAN  |PARTITIONED|
                                                              exchange
                                                              -- ONE_TO_ONE_EXCHANGE  |PARTITIONED|
                                                                empty-tuple-source
                                                                -- EMPTY_TUPLE_SOURCE  |PARTITIONED|
