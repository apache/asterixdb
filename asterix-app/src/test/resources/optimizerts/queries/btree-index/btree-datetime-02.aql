/*
 *  Description     : This test is intended to verify that the primary BTree index is used 
 *                  : for an invocation of current-datetime()
 *  Expected Result : Success
 *  Date            : 27th Aug 2015
 *	Author			: Steven Jacobs
 */

drop dataverse emergencyTest if exists;
create dataverse emergencyTest;
use dataverse emergencyTest;
create type CHPReport as {
        "id":int,
	"timestamp":datetime,
        "title":string,
        "message":string
}
create dataset CHPReports(CHPReport)
primary key timestamp;

for $emergency in dataset CHPReports
let $time := current-datetime() - day-time-duration("PT10H")
where $emergency.timestamp >= $time
return $emergency;