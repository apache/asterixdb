DataverseUse test
TypeDecl TestType [
  closed RecordType {
    key1 : int32,
    value : int32
  }
]
DatasetDecl test(TestType) partitioned by [[key1]]
Query:
SELECT ELEMENT [
RecordConstructor [
  (
    LiteralExpr [STRING] [gid]
    :
    Variable [ Name=aid ]
  )
  (
    LiteralExpr [STRING] [avg]
    :
    FunctionCall test.avg@1[
      (
        SELECT ELEMENT [
        FieldAccessor [
          Variable [ Name=j ]
          Field=value
        ]
        ]
        FROM [          Variable [ Name=i ]
          AS
          Variable [ Name=j ]
        ]
        Where
          FunctionCall test.not@1[
            FunctionCall test.is-null@1[
              FieldAccessor [
                Variable [ Name=j ]
                Field=value
              ]
            ]
          ]
      )
    ]
  )
]
]
FROM [  FunctionCall Metadata.dataset@1[
    LiteralExpr [STRING] [test]
  ]
  AS
  Variable [ Name=i ]
]
Groupby
  Variable [ Name=aid ]
  :=
  FieldAccessor [
    Variable [ Name=i ]
    Field=key1
  ]
  With
  Variable [ Name=i ]

